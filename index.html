<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TH True DNA – Tinh Thể Sữa Độc Bản</title>
  <!-- Thêm font Playfair Display cho nét sang trọng, cổ điển kiểu High-end và Montserrat cho độ thanh lịch -->
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500&family=Montserrat:wght@300;400;500&display=swap" rel="stylesheet">
  <style>
    :root {
      --navy:       #003E7E;
      --navy-deep:  #002B5C;
      --navy-dark:  #001830;
      --blue-mid:   #0057A8;
      --blue-bright:#0072CE;
      --sky:        #A8D8F0;
      --sky-light:  #D6EEFA;
      --white:      #FFFFFF;
      --cream:      #F0F6FC;
      --gold:       #C9A84C;
      --gold-light: #E8C97A;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }
    html { scroll-behavior: smooth; }

    body {
      background: var(--navy-dark);
      color: var(--white);
      font-family: 'Montserrat', sans-serif;
      overflow-x: hidden;
    }

    /* ── CANVAS ── */
    #crystalCanvas {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 0;
      opacity: 0.35;
    }

    /* ── NAVBAR ── */
    nav {
      position: fixed;
      top: 0; left: 0; right: 0;
      z-index: 100;
      padding: 18px 60px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: linear-gradient(to right, rgb(247, 248, 255), rgb(255, 251, 253));
      backdrop-filter: blur(20px);
      border-bottom: 1px solid rgba(0, 24, 48, 0.1);
      box-shadow: 0 4px 20px rgba(0,0,0,0.05);
    }

    .nav-logo {
      display: flex;
      align-items: center;
      gap: 2px;
    }

    .img-th {
      height: 48px;
      margin-right: -10px; /* Pulls text closer if the image has blank space */
      mix-blend-mode: darken;
    }

    .logo-text {
      display: flex;
      align-items: baseline;
      gap: 5px;
      color: rgb(0, 61, 121); /* Matches deep blue from TH logo */
    }

    .text-true {
      font-family: 'Playfair Display', serif;
      font-size: 1.8rem;
      font-weight: 700;
      font-style: italic;
      text-transform: lowercase;
    }

    .text-dna {
      font-family: 'Montserrat', sans-serif;
      font-size: 1.45rem;
      font-weight: 300;
      text-transform: uppercase;
      letter-spacing: 0.1em;
    }

    .nav-links {
      display: flex;
      gap: 36px;
      list-style: none;
    }

    .nav-links a {
      color: var(--navy-dark);
      text-decoration: none;
      font-size: 0.82rem;
      font-weight: 500;
      letter-spacing: 0.14em;
      text-transform: uppercase;
      transition: color .3s;
    }

    .nav-links a:hover { color: var(--blue-mid); }

    .nav-cta {
      padding: 10px 24px;
      background: transparent;
      border: 1px solid var(--blue-mid);
      color: var(--blue-mid);
      font-family: 'Montserrat', sans-serif;
      font-size: 0.8rem;
      font-weight: 600;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      cursor: pointer;
      transition: all .3s;
    }

    .nav-cta:hover {
      background: var(--blue-mid);
      color: var(--white);
    }

    /* ── HERO ── */
    .hero {
      position: relative;
      /* Reduced height significantly to pull everything up */
      min-height: 85vh; 
      display: flex;
      /* Align to flex-start to allow manual top positioning */
      align-items: flex-start; 
      justify-content: center;
      /* Reduced top padding even further - closer to nav height */
      padding: 90px 60px 40px; 
      overflow: hidden;
      background: var(--navy-dark); /* Dark navy color like the rest of the body/sections (#001830) */
    }

    .hero-bg {
      position: absolute;
      inset: 0;
      /* Gradient Mesh hiện đại pha trộn các tone xanh đại dương và xanh tinh thể */
      background:
        radial-gradient(circle at 10% 20%, rgba(0, 114, 206, 0.4) 0%, transparent 60%),
        radial-gradient(circle at 90% 80%, rgba(0, 87, 168, 0.45) 0%, transparent 60%),
        radial-gradient(ellipse 70% 50% at 50% 100%, rgba(168, 216, 240, 0.25) 0%, transparent 70%);
      z-index: 0;
    }

    /* Họa tiết lưới Tinh thể/DNA hiện đại in chìm */
    .hero-bg::before {
      content: '';
      position: absolute;
      inset: 0;
      background-image: url("data:image/svg+xml,%3Csvg width='60' height='103.923' viewBox='0 0 60 103.923' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M30 103.923L0 86.6025V51.9615L30 34.641L60 51.9615V86.6025L30 103.923zM30 0L0 17.3205V51.9615L30 34.641L60 51.9615V17.3205L30 0z' fill='none' stroke='white' stroke-width='1.5'/%3E%3C/svg%3E");
      background-size: 60px 103.92px;
      opacity: 0.04;
      mix-blend-mode: overlay;
    }

    /* Cụm ánh sáng ma thuật đại diện cho Dòng Sữa và Tinh Thể số */
    .hero-circle {
      position: absolute;
      border-radius: 50%;
      filter: blur(90px);
      mix-blend-mode: screen;
      animation: floatOrb 15s ease-in-out infinite alternate;
      pointer-events: none;
    }
    
    .hero-circle:nth-child(1) { width: 45vw; height: 45vw; top: -10%; left: -10%; background: radial-gradient(circle, #0072CE, transparent 70%); animation-delay: 0s; }
    .hero-circle:nth-child(2) { width: 55vw; height: 55vw; bottom: -20%; right: -10%; background: radial-gradient(circle, #00B4D8, transparent 70%); animation-delay: -5s; animation-duration: 20s; }
    .hero-circle:nth-child(3) { width: 35vw; height: 35vw; top: 40%; left: 50%; background: radial-gradient(circle, #A8D8F0, transparent 70%); transform: translate(-50%, -50%); animation-delay: -10s; animation-duration: 12s; }

    @keyframes floatOrb {
      0%   { transform: translate(0, 0) scale(1); }
      50%  { transform: translate(5%, 10%) scale(1.1); }
      100% { transform: translate(-5%, -10%) scale(0.9); }
    }

    .hero-content {
      position: relative;
      z-index: 2;
      text-align: center;
      max-width: 820px;
    }

    .hero-badge {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 6px 18px;
      border: 1px solid rgba(168,216,240,0.4);
      background: rgba(168,216,240,0.1);
      backdrop-filter: blur(10px);
      border-radius: 30px; /* Bo bo cong lại nhìn gen-Z và hiện đại hơn */
      font-size: 0.75rem;
      font-weight: 500;
      letter-spacing: 0.22em;
      text-transform: uppercase;
      color: var(--sky);
      margin-bottom: 32px;
      animation: fadeUp .8s ease both;
      box-shadow: 0 0 20px rgba(168, 216, 240, 0.2);
    }

    .hero-badge::before, .hero-badge::after {
      content: '';
      width: 8px; height: 8px;
      background: var(--sky);
      border-radius: 50%;
      animation: pulse 2s infinite;
      box-shadow: 0 0 10px var(--sky);
    }
    
    .hero-badge::before {
      margin-right: 8px;
    }

    .hero-badge::after {
      margin-left: 8px;
    }

    @keyframes pulse {
      0%,100% { opacity:1; transform:scale(1); }
      50%      { opacity:.4; transform:scale(1.6); }
    }

    .hero-title {
      font-family: 'Playfair Display', serif;
      font-size: clamp(3.5rem, 8vw, 7rem);
      font-weight: 500;
      line-height: 1.1;
      margin-bottom: 24px;
      animation: fadeUp .9s ease .15s both;
      text-shadow: 0 15px 40px rgba(0, 114, 206, 0.6);
      letter-spacing: -0.01em;
    }
    
    .hero-title .line-1 {
      display: block;
      margin-bottom: 0.15em;
      background: linear-gradient(135deg, #FFFFFF 20%, #A8D8F0 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      font-family: 'Playfair Display', serif;
      font-size: clamp(3.5rem, 8vw, 7rem);
      font-weight: 700;
      letter-spacing: -0.01em;
    }

    .hero-title .line-2 {
      display: block;
      margin-top: 0.1em;
      font-style: italic;
      background: linear-gradient(90deg, #E8C97A, #C9A84C, #E8C97A);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      font-family: 'Montserrat', sans-serif;
      font-size: clamp(2.2rem, 5vw, 4rem);
      font-weight: 600;
      letter-spacing: 0.05em;
    }

    .hero-sub {
      font-size: 1rem;
      color: rgba(255,255,255,0.52);
      font-weight: 300;
      line-height: 1.8;
      max-width: 560px;
      margin: 24px auto 48px;
      animation: fadeUp 1s ease .3s both;
    }

    .hero-actions {
      display: flex;
      gap: 16px;
      justify-content: center;
      animation: fadeUp 1s ease .45s both;
    }

    .btn-primary {
      padding: 16px 40px;
      background: linear-gradient(135deg, var(--navy), var(--blue-bright));
      border: 1px solid var(--blue-bright);
      color: var(--white);
      font-family: 'DM Sans', sans-serif;
      font-size: 0.82rem;
      font-weight: 500;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      cursor: pointer;
      transition: all .3s;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 10px;
      clip-path: polygon(8px 0%,100% 0%,calc(100% - 8px) 100%,0% 100%);
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 40px rgba(0,114,206,0.45);
    }

    .btn-secondary {
      padding: 16px 40px;
      background: transparent;
      border: 1px solid rgba(255,255,255,0.2);
      color: rgba(255,255,255,0.65);
      font-family: 'DM Sans', sans-serif;
      font-size: 0.82rem;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      cursor: pointer;
      transition: all .3s;
      text-decoration: none;
      clip-path: polygon(8px 0%,100% 0%,calc(100% - 8px) 100%,0% 100%);
    }

    .btn-secondary:hover {
      border-color: var(--sky);
      color: var(--sky);
    }

    /* Crystal shape hero */
    .hero-crystal {
      position: absolute;
      right: 7%;
      top: 50%;
      transform: translateY(-50%);
      width: 280px;
      animation: floatCrystal 8s ease-in-out infinite;
      z-index: 3;
    }

    @keyframes floatCrystal {
      0%,100% { transform: translateY(-50%) rotate(0deg); }
      50%      { transform: translateY(calc(-50% - 30px)) rotate(3deg); }
    }

    .hero-crystal svg { 
      filter: drop-shadow(0 0 36px rgba(168,216,240,0.6)); 
      animation: crystalGlow 4s ease-in-out infinite alternate;
    }

    @keyframes crystalGlow {
      0% { filter: drop-shadow(0 0 25px rgba(168,216,240,0.4)) drop-shadow(0 0 50px rgba(0,114,206,0.3)); }
      100% { filter: drop-shadow(0 0 45px rgba(168,216,240,0.9)) drop-shadow(0 0 90px rgba(0,114,206,0.6)); }
    }

    @keyframes fadeUp {
      from { opacity:0; transform:translateY(30px); }
      to   { opacity:1; transform:translateY(0); }
    }

    /* ── SECTION HELPERS ── */
    section { position: relative; z-index: 1; }

    .section-label {
      font-size: 0.68rem;
      letter-spacing: 0.26em;
      text-transform: uppercase;
      color: var(--sky);
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .section-label::before {
      content: '';
      width: 32px;
      height: 1px;
      background: var(--sky);
      display: block;
    }

    /* ── ABOUT ── */
    .about {
      padding: 120px 60px;
      background: rgba(0,43,92,0.45);
      backdrop-filter: blur(2px);
    }

    .about-grid {
      max-width: 1200px;
      margin: 0 auto;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 80px;
      align-items: center;
    }

    /* DNA visual */
    .dna-visual {
      width: 100%;
      max-width: 440px;
      aspect-ratio: 1;
      position: relative;
    }

    .dna-ring {
      position: absolute;
      border-radius: 50%;
      border: 1px solid;
      animation: spinRing linear infinite;
    }

    .dna-ring:nth-child(1) { inset:0;   border-color:rgba(0,114,206,.25); animation-duration:20s; }
    .dna-ring:nth-child(2) { inset:12%; border-color:rgba(168,216,240,.2); animation-duration:15s; animation-direction:reverse; }
    .dna-ring:nth-child(3) { inset:24%; border-color:rgba(201,168,76,.3);  animation-duration:10s; }

    @keyframes spinRing { to { transform:rotate(360deg); } }

    .dna-center {
      position: absolute;
      inset: 36%;
      background: radial-gradient(circle, rgba(168,216,240,.25), rgba(0,62,126,.6));
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: 'Cormorant Garamond', serif;
      font-size: 2rem;
      font-weight: 600;
      color: var(--sky);
      border: 1px solid rgba(168,216,240,.35);
    }

    .orbit-dot {
      position: absolute;
      border-radius: 50%;
      top: calc(50% - 4px);
      left: calc(50% - 4px);
      width: 8px; height: 8px;
    }

    .orbit-dot:nth-child(4) {
      background: var(--sky); box-shadow: 0 0 10px var(--sky);
      animation: orbitA 4s linear infinite; margin-left: 46%;
    }
    .orbit-dot:nth-child(5) {
      background: var(--gold-light); box-shadow: 0 0 10px var(--gold);
      animation: orbitA 6s linear infinite reverse; margin-left: 36%;
    }
    .orbit-dot:nth-child(6) {
      background: #fff; box-shadow: 0 0 8px #fff;
      animation: orbitA 8s linear infinite; margin-left: 28%;
    }

    @keyframes orbitA {
      from { transform: rotate(0deg) translateX(0); }
      to   { transform: rotate(360deg) translateX(0); }
    }

    .about-text h2 {
      font-family: 'Cormorant Garamond', serif;
      font-size: clamp(2.2rem, 4vw, 3.2rem);
      font-weight: 300;
      line-height: 1.15;
      margin-bottom: 24px;
      color: var(--cream);
    }

    .about-text h2 em { color: var(--sky); font-style: italic; }

    .about-text p {
      font-size: 0.96rem;
      line-height: 1.85;
      color: rgba(255,255,255,.58);
      margin-bottom: 18px;
    }

    .about-text p strong { color: var(--cream); font-weight: 500; }

    .about-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 28px;
    }

    .tag {
      padding: 6px 14px;
      border: 1px solid rgba(0,114,206,.35);
      background: rgba(0,114,206,.08);
      color: var(--sky);
      font-size: 0.73rem;
      letter-spacing: 0.12em;
      text-transform: uppercase;
    }

    /* ── HOW IT WORKS ── */
    .how { padding: 120px 60px; }

    .how-inner { max-width: 1200px; margin: 0 auto; }

    .how-header {
      text-align: center;
      margin-bottom: 72px;
    }

    .how-header .section-label { justify-content: center; }
    .how-header .section-label::before { display: inline-block; }

    .how-header h2 {
      font-family: 'Cormorant Garamond', serif;
      font-size: clamp(2.4rem, 5vw, 3.8rem);
      font-weight: 300;
      color: var(--cream);
      margin-bottom: 14px;
    }

    .how-header h2 em { color: var(--sky); font-style: italic; }
    .how-header p { color: rgba(255,255,255,.48); max-width: 480px; margin: 0 auto; line-height: 1.7; }

    .steps {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 2px;
      background: rgba(0,87,168,0.2);
      border: 1px solid rgba(0,87,168,0.25);
    }

    .step {
      background: var(--navy-dark);
      padding: 48px 28px;
      position: relative;
      overflow: hidden;
      transition: background .3s;
    }

    .step:hover { background: rgba(0,43,92,0.8); }

    .step::after {
      content: '';
      position: absolute;
      bottom: 0; left: 0;
      height: 2px; width: 0;
      background: linear-gradient(90deg, var(--navy), var(--sky));
      transition: width .5s ease;
    }

    .step:hover::after { width: 100%; }

    .step:not(:last-child)::before {
      content: '→';
      position: absolute;
      right: -13px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--sky);
      font-size: 1.1rem;
      z-index: 2;
    }

    .step-num {
      font-family: 'Cormorant Garamond', serif;
      font-size: 3.8rem;
      font-weight: 300;
      color: rgba(168,216,240,.12);
      line-height: 1;
      margin-bottom: 20px;
    }

    .step-icon { width: 46px; height: 46px; margin-bottom: 18px; }

    .step h3 {
      font-family: 'Cormorant Garamond', serif;
      font-size: 1.35rem;
      font-weight: 400;
      color: var(--cream);
      margin-bottom: 10px;
    }

    .step p { font-size: 0.86rem; line-height: 1.75; color: rgba(255,255,255,.48); }

    /* ── CRYSTALS ── */
    .crystals {
      padding: 120px 60px;
      background: rgba(0,43,92,0.35);
      overflow: hidden;
    }

    .crystals-inner { max-width: 1200px; margin: 0 auto; }

    .crystals-header {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 60px;
      align-items: end;
      margin-bottom: 60px;
    }

    .crystals-header h2 {
      font-family: 'Cormorant Garamond', serif;
      font-size: clamp(2.2rem, 4vw, 3.4rem);
      font-weight: 300;
      line-height: 1.15;
      color: var(--cream);
    }

    .crystals-header h2 em { color: var(--gold-light); font-style: italic; }
    .crystals-header p { color: rgba(255,255,255,.5); line-height: 1.8; }

    .crystal-grid {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 20px;
    }

    .crystal-card {
      position: relative;
      width: calc(33.333% - 14px);
      min-width: 260px;
      aspect-ratio: 3/4;
      overflow: hidden;
      border: 1px solid rgba(255, 255, 255, .07);
      cursor: pointer;
    }

    .crystal-card-bg {
      position: absolute;
      inset: 0;
      transition: transform .6s ease;
    }

    .crystal-card:hover .crystal-card-bg { transform: scale(1.05); }

    .crystal-card-bg.sunflower {
      background: radial-gradient(ellipse at 50% 30%, #FFE066 0%, #F5A623 45%, #8B5E0A 100%);
    }

    .crystal-card-bg.pure {
      background: radial-gradient(ellipse at 50% 30%, #E8F4FF 0%, #A8D8F0 40%, #1C6FAD 100%);
    }

    .crystal-card-bg.emerald {
      background: radial-gradient(ellipse at 50% 30%, #88E2D0 0%, #209C82 45%, #003E5C 100%);
    }

    .crystal-card-bg.coral {
      background: radial-gradient(ellipse at 50% 30%, #FFB6A1 0%, #FF6B57 45%, #8A2519 100%);
    }

    .crystal-card-bg.rosequartz {
      background: radial-gradient(ellipse at 50% 30%, #FFE5E8 0%, #F48FB1 45%, #882A4A 100%);
    }

    .crystal-inner-shape {
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .crystal-inner-shape svg {
      width: 62%;
      opacity: .88;
      filter: drop-shadow(0 0 22px rgba(255,255,255,.55));
      animation: shimmer 4s ease-in-out infinite;
    }

    @keyframes shimmer {
      0%,100% { filter: drop-shadow(0 0 18px rgba(255,255,255,.5)); }
      50%      { filter: drop-shadow(0 0 42px rgba(255,255,255,.9)); }
    }

    .crystal-overlay {
      position: absolute;
      bottom: 0; left: 0; right: 0;
      background: linear-gradient(transparent, rgba(0,20,50,.88));
      padding: 32px 22px 22px;
      transform: translateY(28px);
      opacity: 0;
      transition: all .4s ease;
    }

    .crystal-card:hover .crystal-overlay { transform: translateY(0); opacity: 1; }

    .crystal-name {
      font-family: 'Cormorant Garamond', serif;
      font-size: 1.4rem;
      color: var(--white);
      margin-bottom: 6px;
    }

    .crystal-desc { font-size: 0.78rem; color: rgba(255,255,255,.68); line-height: 1.6; }

    .crystal-badge {
      position: absolute;
      top: 14px; right: 14px;
      padding: 4px 10px;
      background: rgba(0,0,0,.45);
      backdrop-filter: blur(8px);
      border: 1px solid rgba(255,255,255,.2);
      font-size: 0.63rem;
      letter-spacing: 0.16em;
      text-transform: uppercase;
      color: rgba(255,255,255,.8);
    }

    /* ── INPUT SECTION ── */
    .input-section {
      padding: 120px 60px;
      text-align: center;
      background: radial-gradient(ellipse 80% 80% at 50% 110%, rgba(0,114,206,.22), transparent 68%), var(--navy-dark);
    }

    .input-inner { max-width: 620px; margin: 0 auto; }

    .input-inner h2 {
      font-family: 'Cormorant Garamond', serif;
      font-size: clamp(2.4rem, 5vw, 3.8rem);
      font-weight: 300;
      color: var(--cream);
      margin-bottom: 14px;
      line-height: 1.1;
    }

    .input-inner h2 em { color: var(--sky); font-style: italic; }

    .input-inner > p {
      color: rgba(255,255,255,.48);
      margin-bottom: 48px;
      line-height: 1.75;
    }

    .code-input-wrap {
      display: flex;
      margin-bottom: 18px;
    }

    .code-input {
      flex: 1;
      background: rgba(255,255,255,.04);
      border: 1px solid rgba(0,114,206,.35);
      border-right: none;
      padding: 18px 22px;
      color: var(--white);
      font-family: 'DM Sans', sans-serif;
      font-size: 0.95rem;
      letter-spacing: 0.14em;
      outline: none;
      transition: border-color .3s;
    }

    .code-input::placeholder { color: rgba(255,255,255,.2); }
    .code-input:focus { border-color: var(--sky); }

    .code-submit {
      padding: 18px 32px;
      background: linear-gradient(135deg, var(--navy), var(--blue-bright));
      border: 1px solid var(--blue-bright);
      border-left: none;
      color: var(--white);
      font-family: 'DM Sans', sans-serif;
      font-size: 0.82rem;
      font-weight: 500;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      cursor: pointer;
      transition: all .3s;
      white-space: nowrap;
    }

    .code-submit:hover { box-shadow: 0 0 30px rgba(0,114,206,.45); }

    .input-note {
      font-size: 0.76rem;
      color: rgba(255,255,255,.28);
      letter-spacing: 0.05em;
    }

    /* ── FOOTER ── */
    footer {
      background: rgba(0,0,0,.4);
      border-top: 1px solid rgba(0,114,206,.15);
      padding: 44px 60px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .footer-brand {
      font-family: 'Cormorant Garamond', serif;
      font-size: 1.1rem;
      color: rgba(255,255,255,.45);
    }

    .footer-brand em { color: var(--sky); font-style: normal; }
    .footer-copy { font-size: 0.76rem; color: rgba(255,255,255,.22); letter-spacing: .05em; }

    /* ── REVEAL ── */
    .reveal {
      opacity: 0;
      transform: translateY(36px);
      transition: opacity .8s ease, transform .8s ease;
    }

    .reveal.visible { opacity: 1; transform: translateY(0); }

    /* ── AI MECHANISM SECTION ── */
    .ai-mechanism {
      padding: 120px 60px;
      background: var(--navy-dark);
      overflow: hidden;
    }

    .ai-inner { max-width: 1200px; margin: 0 auto; }

    .ai-header {
      text-align: center;
      margin-bottom: 80px;
    }

    .ai-header .section-label { justify-content: center; }
    .ai-header .section-label::before { display: inline-block; }

    .ai-header h2 {
      font-family: 'Cormorant Garamond', serif;
      font-size: clamp(2.4rem, 5vw, 3.8rem);
      font-weight: 300;
      color: var(--cream);
      margin-bottom: 14px;
    }

    .ai-header h2 em { color: var(--sky); font-style: italic; }
    .ai-header p { color: rgba(255,255,255,.48); max-width: 520px; margin: 0 auto; line-height: 1.7; }

    /* Pipeline flow */
    .pipeline {
      display: flex;
      align-items: stretch;
      gap: 0;
      margin-bottom: 80px;
      border: 1px solid rgba(0,114,206,0.2);
    }

    .pipeline-node {
      flex: 1;
      padding: 36px 28px;
      background: rgba(0,43,92,0.3);
      position: relative;
      transition: background .3s;
    }

    .pipeline-node:hover { background: rgba(0,43,92,0.6); }

    .pipeline-node:not(:last-child)::after {
      content: '';
      position: absolute;
      right: -1px; top: 50%;
      transform: translateY(-50%);
      width: 0; height: 0;
      border-top: 18px solid transparent;
      border-bottom: 18px solid transparent;
      border-left: 18px solid var(--navy-dark);
      z-index: 2;
    }

    .pipeline-node:not(:last-child)::before {
      content: '';
      position: absolute;
      right: -20px; top: 50%;
      transform: translateY(-50%);
      width: 0; height: 0;
      border-top: 20px solid transparent;
      border-bottom: 20px solid transparent;
      border-left: 20px solid rgba(0,114,206,0.3);
      z-index: 1;
    }

    .pipeline-node:last-child {
      background: linear-gradient(135deg, rgba(0,62,126,0.5), rgba(0,114,206,0.25));
      border-left: 1px solid rgba(168,216,240,0.25);
    }

    .node-icon {
      width: 44px; height: 44px;
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .node-label {
      font-size: 0.65rem;
      letter-spacing: 0.22em;
      text-transform: uppercase;
      color: var(--sky);
      margin-bottom: 8px;
      opacity: .7;
    }

    .node-title {
      font-family: 'Cormorant Garamond', serif;
      font-size: 1.25rem;
      color: var(--cream);
      margin-bottom: 10px;
      font-weight: 400;
    }

    .node-desc {
      font-size: 0.82rem;
      color: rgba(255,255,255,.45);
      line-height: 1.7;
    }

    .node-code {
      margin-top: 12px;
      padding: 10px 14px;
      background: rgba(0,0,0,.35);
      border-left: 2px solid var(--sky);
      font-family: 'Courier New', monospace;
      font-size: 0.75rem;
      color: var(--sky);
      line-height: 1.6;
      opacity: .85;
    }

    /* Personalization table */
    .personalization {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 48px;
      align-items: start;
    }

    .pers-left h3 {
      font-family: 'Cormorant Garamond', serif;
      font-size: 2rem;
      font-weight: 300;
      color: var(--cream);
      margin-bottom: 12px;
      line-height: 1.2;
    }

    .pers-left h3 em { color: var(--sky); font-style: italic; }
    .pers-left p { color: rgba(255,255,255,.5); font-size: .92rem; line-height: 1.75; margin-bottom: 24px; }

    .seed-breakdown {
      padding: 20px 24px;
      background: rgba(0,0,0,.3);
      border: 1px solid rgba(0,114,206,.2);
      font-family: 'Courier New', monospace;
      font-size: 0.85rem;
    }

    .seed-row {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 8px 0;
      border-bottom: 1px solid rgba(255,255,255,.06);
    }

    .seed-row:last-child { border-bottom: none; }

    .seed-key {
      color: var(--sky);
      font-size: .72rem;
      letter-spacing: .08em;
      min-width: 130px;
      opacity: .8;
    }

    .seed-val {
      color: rgba(255,255,255,.75);
      font-size: .8rem;
    }

    .seed-val span {
      color: var(--gold-light);
    }

    .pers-right { display: flex; flex-direction: column; gap: 14px; }

    .pers-card {
      display: flex;
      align-items: center;
      gap: 20px;
      padding: 20px 22px;
      background: rgba(0,43,92,.3);
      border: 1px solid rgba(0,114,206,.15);
      border-left: 3px solid;
      transition: background .3s;
    }

    .pers-card:hover { background: rgba(0,43,92,.6); }

    .pers-card:nth-child(1) { border-left-color: var(--sky); }
    .pers-card:nth-child(2) { border-left-color: var(--gold-light); }
    .pers-card:nth-child(3) { border-left-color: #90E0C0; }
    .pers-card:nth-child(4) { border-left-color: #C0A0FF; }

    .pers-card-icon {
      width: 40px; height: 40px;
      flex-shrink: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.4rem;
    }

    .pers-card-body { flex: 1; }

    .pers-card-title {
      font-size: .82rem;
      color: var(--cream);
      font-weight: 500;
      margin-bottom: 4px;
    }

    .pers-card-desc {
      font-size: .76rem;
      color: rgba(255,255,255,.45);
      line-height: 1.6;
    }

    .pers-card-result {
      font-size: .72rem;
      color: var(--sky);
      letter-spacing: .08em;
      text-align: right;
      white-space: nowrap;
      opacity: .8;
    }

    /* ── RESPONSIVE ── */
    @media (max-width: 900px) {
      nav { padding: 14px 20px; }
      .nav-links { display: none; }
      .hero { padding: 100px 24px 60px; }
      .hero-crystal { display: none; }
      .about { padding: 80px 24px; }
      .about-grid { grid-template-columns: 1fr; gap: 48px; }
      .ai-mechanism { padding: 80px 24px; }
      .pipeline { flex-direction: column; }
      .pipeline-node:not(:last-child)::after,
      .pipeline-node:not(:last-child)::before { display: none; }
      .personalization { grid-template-columns: 1fr; gap: 40px; }

      .steps { grid-template-columns: 1fr 1fr; }
      .crystals { padding: 80px 24px; }
      .crystals-header { grid-template-columns: 1fr; gap: 20px; }
      .crystal-grid { grid-template-columns: 1fr 1fr; }
      .input-section { padding: 80px 24px; }
      footer { padding: 28px 20px; flex-direction: column; gap: 12px; text-align: center; }
    }

    @media (max-width: 560px) {
      .steps { grid-template-columns: 1fr; }
      .crystal-grid { grid-template-columns: 1fr; }
      .hero-actions { flex-direction: column; align-items: center; }
    }
  </style>
</head>
<body>

<canvas id="crystalCanvas"></canvas>

<!-- NAVBAR -->
<nav>
  <a href="#" class="nav-logo" style="text-decoration: none;">
    <img src="asset/TH.png" alt="TH Logo" class="img-th" />
    <span class="logo-text">
      <span class="text-true">true</span>
      <span class="text-dna">DNA</span>
    </span>
  </a>
  <ul class="nav-links">
    <li><a href="#about">Chiến dịch</a></li>
    <li><a href="#how">Cách thức</a></li>
    <li><a href="#crystals">Tinh thể</a></li>
    <li><a href="#redeem">Nhận ngay</a></li>
  </ul>
  <button class="nav-cta">Nhập mã ngay</button>
</nav>

<!-- HERO -->
<section class="hero">
  <div class="hero-visual-layout" style="display: flex; align-items: center; justify-content: space-between; position: relative; min-height: 420px;">
    <div class="hero-text-side" style="flex: 1.2; text-align: left; padding-left: 6vw; z-index: 2; display: flex; flex-direction: column; justify-content: flex-start; padding-top: 0; margin-top: -10px;">
      <!-- Centered Badge with new text "TH true DNA" -->
      <div class="hero-badge" style="align-self: center; margin-bottom: 8px; padding-left: 40px; padding-right: 40px; display: inline-flex; align-items: center; justify-content: center; margin-top: 10px;">TH true DNA</div>
      
      <!-- Title on 2 separate lines, no wrapping -->
      <h1 class="hero-title" style="white-space: nowrap; margin-bottom: 8px; line-height: 1.3; padding-top: 15px;">
        <span class="line-1" style="display: block; padding-bottom: 0;">Tinh Thể Sữa</span>
        <!-- Line 2: aligned right, lowercase text, size 28px (smaller than 40px) -->
        <span class="line-2" style="display: block; margin-top: -10px; font-size: 28px; text-align: right; letter-spacing: 0.1em; opacity: 0.9;">chỉ của riêng bạn</span>
      </h1>
      
      <p class="hero-sub" style="text-align: justify; margin-left: auto; margin-right: auto; max-width: 580px; letter-spacing: 0.02em; margin-bottom: 16px;">
        Mỗi hộp sữa TH chứa đựng một mã số định danh độc bản – "hạt giống" để công nghệ AI khai mở nguồn năng lượng tinh khiết, kiến tạo nên <b>tác phẩm tinh thể ánh sáng lộng lẫy</b>, mang dấu ấn duy nhất thuộc về chính bạn.
      </p>
      
      <div class="hero-actions" style="justify-content: center; gap: 24px;">
        <a href="#redeem" class="btn-primary crystal-btn">
          <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>
          Đúc Tinh Thể Ngay
        </a>
        <a href="#about" class="btn-secondary crystal-btn-outline">Khám Phá Thêm</a>
      </div>
      
      <style>
        /* Crystal Button Styles */
        .crystal-btn {
          background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
          backdrop-filter: blur(10px);
          border: 1px solid rgba(168, 216, 240, 0.5);
          box-shadow: 0 0 15px rgba(168, 216, 240, 0.2), inset 0 0 20px rgba(168, 216, 240, 0.1);
          color: #fff;
          border-radius: 0;
          clip-path: polygon(10% 0, 100% 0, 100% 90%, 90% 100%, 0 100%, 0 10%);
          transition: all 0.4s ease;
          text-shadow: 0 0 8px rgba(168, 216, 240, 0.6);
          padding: 16px 40px;
          text-decoration: none;
          text-transform: uppercase;
          font-weight: 600;
          font-size: 0.85rem;
          letter-spacing: 0.15em;
          display: inline-flex;
          align-items: center;
          gap: 10px;
        }
        
        .crystal-btn:hover {
          background: linear-gradient(135deg, rgba(168, 216, 240, 0.3), rgba(0, 114, 206, 0.4));
          border-color: #fff;
          box-shadow: 0 0 30px rgba(168, 216, 240, 0.5), inset 0 0 20px rgba(168, 216, 240, 0.3);
          transform: translateY(-2px) scale(1.02);
          text-shadow: 0 0 12px rgba(255, 255, 255, 0.8);
        }

        .crystal-btn-outline {
          background: transparent;
          border: 1px solid rgba(255, 255, 255, 0.3);
          color: rgba(255, 255, 255, 0.8);
          clip-path: polygon(0 0, 90% 0, 100% 10%, 100% 100%, 10% 100%, 0 90%);
          transition: all 0.4s ease;
          padding: 16px 40px;
          text-decoration: none;
          text-transform: uppercase;
          font-weight: 500;
          font-size: 0.85rem;
          letter-spacing: 0.15em;
        }

        .crystal-btn-outline:hover {
          background: rgba(255, 255, 255, 0.05);
          border-color: #fff;
          color: #fff;
          box-shadow: 0 0 20px rgba(255, 255, 255, 0.15);
          transform: translateY(-2px);
        }
      </style>
    </div>
    <div class="hero-image-side" style="flex: 1.2; position: relative; height: 750px; display: flex; align-items: center; justify-content: center;">
      <div style="position: relative; width: 100%; height: 100%; max-width: 850px; display: flex; align-items: center; justify-content: center; top: 350px;">
        <!-- Main Milk Carton (Image 5) - Moved right slightly -->
        <img src="asset/5.png" class="hero-milk-main" alt="Hộp sữa chính" 
             style="width: 650px; max-width: 100%; z-index: 20; position: relative; left: 40px; filter: drop-shadow(0 0 80px rgba(168, 216, 240, 0.6)); animation: floatCrystal 6s ease-in-out infinite;">
        
        <!-- Scattered Floating Elements - Smaller and moved UP (~50px equivalent adjustment) -->
        <!-- Image 1: Smaller, moved Up further (-50px -> -120px) -->
        <img src="asset/1.png" style="width: 100px; position: absolute; top: -120px; left: 10%; z-index: 5; filter: drop-shadow(0 0 30px #0072CE); animation: floatOrb 8s ease-in-out infinite;">
        
        <!-- Image 2: Smaller, moved Right (left: 30% -> 50%) -->
        <img src="asset/2.png" style="width: 70px; position: absolute; bottom: 60%; left: 50%; z-index: 8; filter: drop-shadow(0 0 35px #A8D8F0); animation: floatOrb 7s ease-in-out infinite reverse;">
        
        <!-- Image 3: Smaller, moved Up (decreased top) - moved slightly Down from -50px to -20px -->
        <img src="asset/3.png" style="width: 120px; position: absolute; top: -20px; right: 0%; z-index: 4; filter: drop-shadow(0 0 40px #0057A8); animation: floatOrb 9s ease-in-out infinite 1s;">
        
        <!-- Image 4: Moved Left slightly (right: 5% -> 15%) -->
        <img src="asset/4.png" style="width: 60px; position: absolute; top: -150px; right: 15%; z-index: 9; filter: drop-shadow(0 0 25px #FFFFFF); animation: floatOrb 6s ease-in-out infinite 2s;">
        
        <!-- Image 6: Smaller and moved Down (width 70px, top 30%) -->
        <img src="asset/6.png" style="width: 70px; position: absolute; top: 30%; right: 5%; z-index: 6; filter: drop-shadow(0 0 30px #A8D8F0); animation: floatOrb 7.5s ease-in-out infinite 1.5s;">
        
        <!-- Image 7: Bigger, moved Up more (top 30% -> 20%) -->
        <img src="asset/7.png" style="width: 130px; position: absolute; top: 20%; left: 10%; z-index: 3; filter: drop-shadow(0 0 25px #0072CE); animation: floatOrb 8.5s ease-in-out infinite 0.5s;">
      </div>
    </div>
  </div>
</section>

<!-- ABOUT -->
<section class="about" id="about">
  <div class="about-grid">
    <div class="about-visual">
      <div class="dna-visual">
        <div class="dna-ring"></div>
        <div class="dna-ring"></div>
        <div class="dna-ring"></div>
        <div class="dna-center">DNA</div>
        <div class="orbit-dot"></div>
        <div class="orbit-dot"></div>
        <div class="orbit-dot"></div>
      </div>
    </div>

    <div class="about-text reveal">
      <div class="section-label">Về chiến dịch</div>
      <h2>Khoa học · Nghệ thuật ·<br><em>Cá nhân hóa cực hạn</em></h2>
      <p>
        <strong>TH True DNA</strong> lấy cảm hứng từ sự thuần khiết của giọt sữa "Thật" — biến mỗi mã số thẻ cào dưới lốc sữa TH thành một <strong>"hạt giống số"</strong> (Seed) độc nhất vô nhị.
      </p>
      <p>
        Thay vì những phần quà vật chất thông thường, chúng tôi tặng cho mỗi khách hàng một <strong>tác phẩm nghệ thuật tinh thể sữa</strong> được kiến tạo bởi trí tuệ nhân tạo — sự kết hợp hoàn hảo giữa khoa học, nghệ thuật và cá nhân hóa trong kỷ nguyên số.
      </p>
      <div class="about-tags">
        <span class="tag">Canvas Engine Generated Art</span>
        <span class="tag">Unique Seed</span>
        <span class="tag">Digital Collectible</span>
        <span class="tag">TH True Milk</span>
      </div>
    </div>
  </div>
</section>

<!-- HOW IT WORKS -->
<section class="how" id="how">
  <div class="how-inner">
    <div class="how-header reveal">
      <div class="section-label" style="justify-content:center;">
        <span style="width:32px;height:1px;background:var(--sky);display:inline-block;"></span>
        Cách thức
      </div>
      <h2>Hành Trình <em>Đúc Tinh Thể</em></h2>
      <p>4 bước đơn giản để sở hữu tác phẩm nghệ thuật số độc bản của riêng bạn</p>
    </div>

    <div class="steps reveal">
      <div class="step">
        <div class="step-num">01</div>
        <svg class="step-icon" viewBox="0 0 48 48" fill="none">
          <rect x="8" y="6" width="32" height="36" rx="2" stroke="#A8D8F0" stroke-width="1.5"/>
          <rect x="14" y="26" width="20" height="10" rx="1" stroke="#A8D8F0" stroke-width="1.5"/>
          <circle cx="24" cy="17" r="5" stroke="#0072CE" stroke-width="1.5"/>
        </svg>
        <h3>Mua lốc sữa TH</h3>
        <p>Mỗi lốc sữa TH True Milk đều chứa một mã số định danh duy nhất bên dưới.</p>
      </div>
      <div class="step">
        <div class="step-num">02</div>
        <svg class="step-icon" viewBox="0 0 48 48" fill="none">
          <rect x="6" y="6" width="16" height="16" rx="2" stroke="#A8D8F0" stroke-width="1.5"/>
          <rect x="26" y="6" width="16" height="16" rx="2" stroke="#A8D8F0" stroke-width="1.5"/>
          <rect x="6" y="26" width="16" height="16" rx="2" stroke="#A8D8F0" stroke-width="1.5"/>
          <rect x="30" y="30" width="8" height="8" rx="1" fill="#A8D8F0" opacity="0.45"/>
          <rect x="10" y="10" width="8" height="8" rx="1" fill="#0072CE" opacity="0.4"/>
          <rect x="30" y="10" width="8" height="8" rx="1" fill="#0072CE" opacity="0.4"/>
          <rect x="10" y="30" width="8" height="8" rx="1" fill="#0072CE" opacity="0.4"/>
        </svg>
        <h3>Quét mã QR</h3>
        <p>Quét QR trên bao bì, bạn được dẫn đến "Xưởng đúc tinh thể" của chiến dịch.</p>
      </div>
      <div class="step">
        <div class="step-num">03</div>
        <svg class="step-icon" viewBox="0 0 48 48" fill="none">
          <rect x="8" y="14" width="32" height="24" rx="2" stroke="#A8D8F0" stroke-width="1.5"/>
          <path d="M16 26h4M22 22h4M28 26h4" stroke="#0072CE" stroke-width="2" stroke-linecap="round"/>
          <path d="M24 10v4" stroke="#A8D8F0" stroke-width="1.5"/>
        </svg>
        <h3>Nhập mã thẻ cào</h3>
        <p>Chỉ cần nhập dãy số mã thẻ cào — đây chính là "hạt giống" tạo nên tinh thể của bạn.</p>
      </div>
      <div class="step">
        <div class="step-num">04</div>
        <svg class="step-icon" viewBox="0 0 48 48" fill="none">
          <polygon points="24,4 38,16 42,30 24,44 6,30 10,16" stroke="#C9A84C" stroke-width="1.5" fill="none"/>
          <polygon points="24,4 38,16 24,22" fill="#E8C97A" opacity="0.3"/>
          <polygon points="24,4 10,16 24,22" fill="#C9A84C" opacity="0.3"/>
          <line x1="24" y1="4" x2="24" y2="44" stroke="rgba(201,168,76,0.3)" stroke-width="0.8"/>
        </svg>
        <h3>Nhận tinh thể độc bản</h3>
        <p>Phân tích dãy số và "đúc" ngay tác phẩm tinh thể sữa lộng lẫy chỉ dành riêng cho bạn.</p>
      </div>
    </div>
  </div>
</section>
<!-- CRYSTALS -->
<section class="crystals" id="crystals">
  <div class="crystals-inner">
    <div class="crystals-header reveal">
      <div>
        <div class="section-label">Bộ sưu tập</div>
        <h2>Những Tinh Thể<br><em>Lộng Lẫy</em> Chờ Bạn</h2>
      </div>
      <p>Mỗi tinh thể mang màu sắc và ý nghĩa riêng biệt, được sinh ra từ chính dãy số độc nhất của bạn. Không ai có tinh thể giống ai.</p>
    </div>

    <div class="crystal-grid reveal">

      <div class="crystal-card">
        <div class="crystal-card-bg pure"></div>
        <div class="crystal-inner-shape">
          <svg viewBox="0 0 120 160" fill="none">
            <polygon points="60,10 95,50 60,140 25,50" fill="rgba(255,255,255,0.15)" stroke="rgba(255,255,255,0.8)" stroke-width="0.8"/>
            <polygon points="60,10 95,50 60,65" fill="rgba(255,255,255,0.6)"/>
            <polygon points="60,10 25,50 60,65" fill="rgba(168,216,240,0.5)"/>
            <polygon points="95,50 60,140 60,65" fill="rgba(168,216,240,0.3)"/>
            <polygon points="25,50 60,140 60,65" fill="rgba(255,255,255,0.2)"/>
            <polygon points="45,35 75,35 60,65" fill="rgba(255,255,255,0.8)"/>
          </svg>
        </div>
        <div class="crystal-badge">Pha Lê</div>
        <div class="crystal-overlay">
          <div class="crystal-name">Tinh Thể Thuần Khiết</div>
          <div class="crystal-desc">Trong suốt như giọt sữa đầu tiên — biểu tượng của sự tinh khiết và chân thật tự nhiên.</div>
        </div>
      </div>

      <div class="crystal-card">
        <div class="crystal-card-bg sunflower"></div>
        <div class="crystal-inner-shape">
          <svg viewBox="0 0 120 160" fill="none">
            <polygon points="60,40 100,20 70,60" fill="rgba(255,240,120,0.5)"/>
            <polygon points="60,40 20,20 50,60" fill="rgba(255,200,60,0.4)"/>
            <polygon points="70,55 90,70 90,130 70,110" fill="rgba(255,220,60,0.6)"/>
            <polygon points="50,60 10,80 50,100" fill="rgba(255,255,150,0.5)"/>
            <polygon points="60,10 85,80 60,150 35,80" fill="rgba(255,255,255,0.2)" stroke="rgba(255,255,255,0.7)" stroke-width="0.8"/>
            <polygon points="60,10 85,80 60,80" fill="rgba(255,220,60,0.7)"/>
            <polygon points="60,10 35,80 60,80" fill="rgba(255,250,180,0.6)"/>
            <polygon points="85,80 60,150 60,80" fill="rgba(255,180,40,0.4)"/>
            <polygon points="35,80 60,150 60,80" fill="rgba(255,220,60,0.3)"/>
          </svg>
        </div>
        <div class="crystal-badge">Hướng Dương</div>
        <div class="crystal-overlay">
          <div class="crystal-name">Tinh Thể Năng Lượng</div>
          <div class="crystal-desc">Tỏa sáng như ánh bình minh — dành cho những tâm hồn rực rỡ và tràn đầy sức sống.</div>
        </div>
      </div>

      <div class="crystal-card">
        <div class="crystal-card-bg emerald"></div>
        <div class="crystal-inner-shape">
          <svg viewBox="0 0 120 160" fill="none">
            <polygon points="30,60 50,45 50,120 30,100" fill="rgba(100,200,180,0.4)" stroke="rgba(255,255,255,0.5)" stroke-width="0.5"/>
            <polygon points="30,60 40,50 50,45" fill="rgba(255,255,255,0.6)"/>
            <polygon points="70,55 90,70 90,130 70,110" fill="rgba(30,150,130,0.5)" stroke="rgba(255,255,255,0.4)" stroke-width="0.5"/>
            <polygon points="70,55 80,45 90,70" fill="rgba(150,230,210,0.5)"/>
            <polygon points="50,20 75,35 75,140 50,120" fill="rgba(255,255,255,0.2)" stroke="rgba(255,255,255,0.8)" stroke-width="0.8"/>
            <polygon points="50,20 62,10 75,35" fill="rgba(200,255,240,0.7)"/>
            <polygon points="50,20 62,140 50,120" fill="rgba(100,220,190,0.4)"/>
            <polygon points="75,35 62,140 75,140" fill="rgba(40,160,140,0.6)"/>
          </svg>
        </div>
        <div class="crystal-badge">Đại Dương</div>
        <div class="crystal-overlay">
          <div class="crystal-name">Tinh Thể Lục Bảo</div>
          <div class="crystal-desc">Xanh mát và sâu thẳm — biểu tượng của sự tĩnh lặng, mang hơi thở của dòng suối tự nhiên.</div>
        </div>
      </div>

      <div class="crystal-card">
        <div class="crystal-card-bg coral"></div>
        <div class="crystal-inner-shape">
          <svg viewBox="0 0 120 160" fill="none">
            <polygon points="40,110 20,60 35,70" fill="rgba(255,160,140,0.6)" stroke="rgba(255,255,255,0.5)" stroke-width="0.5"/>
            <polygon points="80,120 105,50 90,65" fill="rgba(255,100,80,0.5)" stroke="rgba(255,255,255,0.4)" stroke-width="0.5"/>
            <path d="M50,140 L45,60 L60,20 L75,70 L70,140 Z" fill="rgba(255,255,255,0.15)" stroke="rgba(255,255,255,0.8)" stroke-width="0.8"/>
            <polygon points="45,60 60,20 60,140" fill="rgba(255,180,160,0.7)"/>
            <polygon points="75,70 60,20 60,140" fill="rgba(220,80,60,0.5)"/>
            <polygon points="45,60 60,50 75,70" fill="rgba(255,255,255,0.4)"/>
          </svg>
        </div>
        <div class="crystal-badge">San Hô</div>
        <div class="crystal-overlay">
          <div class="crystal-name">Tinh Thể Nhiệt Huyết</div>
          <div class="crystal-desc">Tự do vươn mình rẽ nhánh — tượng trưng cho sự sáng tạo vô hạn và đam mê bùng cháy.</div>
        </div>
      </div>

      <div class="crystal-card">
        <div class="crystal-card-bg rosequartz"></div>
        <div class="crystal-inner-shape">
          <svg viewBox="0 0 120 160" fill="none">
            <polygon points="70,40 100,55 100,95 70,110 40,95 40,55" fill="rgba(240,120,150,0.3)" stroke="rgba(255,255,255,0.3)" stroke-width="0.5"/>
            <polygon points="70,40 100,55 70,75 40,55" fill="rgba(255,180,200,0.4)"/>
            <polygon points="50,60 85,80 85,130 50,150 15,130 15,80" fill="rgba(255,255,255,0.15)" stroke="rgba(255,255,255,0.8)" stroke-width="0.8"/>
            <polygon points="50,60 85,80 50,100 15,80" fill="rgba(255,230,235,0.8)"/>
            <polygon points="15,80 50,100 50,150 15,130" fill="rgba(255,160,180,0.6)"/>
            <polygon points="85,80 50,100 50,150 85,130" fill="rgba(200,80,110,0.4)"/>
          </svg>
        </div>
        <div class="crystal-badge">Thạch Anh Hồng</div>
        <div class="crystal-overlay">
          <div class="crystal-name">Tinh Thể Chữa Lành</div>
          <div class="crystal-desc">Mềm mại và ấm áp — mang năng lượng của sự thấu cảm, dịu dàng nâng niu cảm xúc.</div>
        </div>
      </div>

    </div>
  </div>
</section>

<!-- REDEEM / CRYSTAL GENERATOR -->
<section class="input-section" id="redeem" style="padding:120px 60px;">
  <div style="max-width:900px;margin:0 auto;text-align:center;">

    <div class="section-label" style="justify-content:center;">
      <span style="width:32px;height:1px;background:var(--sky);display:inline-block;"></span>
      Xưởng đúc tinh thể
    </div>

    <h2 class="reveal" style="font-family:'Cormorant Garamond',serif;font-size:clamp(2.4rem,5vw,3.8rem);font-weight:300;color:var(--cream);margin-bottom:14px;line-height:1.1;">
      Nhập Mã — <em style="color:var(--sky);font-style:italic;">Đúc Ngay</em><br>Tinh Thể Của Bạn
    </h2>
    <p class="reveal" style="color:rgba(255,255,255,.48);margin-bottom:40px;line-height:1.75;">
      Dãy số thẻ cào là "hạt giống" — hệ thống sẽ kiến tạo tinh thể độc bản<br>chỉ dành riêng cho bạn.
    </p>

    <!-- Input row -->
    <div class="reveal" style="display:flex;gap:0;max-width:600px;margin:0 auto 40px;">
      <input id="codeInput" type="text" placeholder="Nhập mã thẻ cào (VD: TH-2026-XXXXXXXX)" maxlength="24"
        style="flex:1;background:rgba(255,255,255,.04);border:1px solid rgba(0,114,206,.35);border-right:none;
               padding:16px 20px;color:#fff;font-family:'DM Sans',sans-serif;font-size:.95rem;
               letter-spacing:.1em;outline:none;transition:border-color .3s;"
        onfocus="this.style.borderColor='rgba(168,216,240,.7)'"
        onblur="this.style.borderColor='rgba(0,114,206,.35)'"
      />
      <button id="codeSubmit" onclick="generateCrystal()"
        style="padding:16px 28px;background:linear-gradient(135deg,var(--navy),var(--blue-bright));
               border:1px solid var(--blue-bright);border-left:none;color:#fff;
               font-family:'DM Sans',sans-serif;font-size:.82rem;font-weight:500;
               letter-spacing:.12em;text-transform:uppercase;cursor:pointer;
               white-space:nowrap;transition:all .3s;
      ">
        Đúc Tinh Thể ✦
      </button>
    </div>

    <!-- Crystal output -->
    <div id="crystalOutput" style="display:none;animation:fadeUp .6s ease both;">
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:40px;align-items:start;text-align:left;
                  border:1px solid rgba(0,114,206,.2);padding:40px;background:rgba(0,43,92,.3);">

        <!-- Canvas -->
        <div style="text-align:center;">
          <canvas id="crystalCanvas2" width="360" height="400"
            style="width:100%;border:1px solid rgba(168,216,240,.12);"></canvas>
          <button onclick="downloadCrystal()"
            style="margin-top:16px;padding:12px 28px;background:transparent;
                   border:1px solid rgba(168,216,240,.4);color:var(--sky);
                   font-family:'DM Sans',sans-serif;font-size:.78rem;letter-spacing:.12em;
                   text-transform:uppercase;cursor:pointer;transition:all .3s;width:100%;"
            onmouseover="this.style.background='rgba(0,114,206,.2)'"
            onmouseout="this.style.background='transparent'">
            ↓ Lưu Tinh Thể
          </button>
        </div>

        <!-- Info -->
        <div>
          <div style="font-size:.65rem;letter-spacing:.22em;text-transform:uppercase;color:var(--sky);
                      margin-bottom:12px;opacity:.7;">Tinh thể của bạn</div>
          <div id="crystalName" style="font-family:'Cormorant Garamond',serif;font-size:2rem;
               font-weight:300;color:var(--cream);margin-bottom:6px;"></div>
          <div id="crystalType" style="font-size:.8rem;color:var(--sky);letter-spacing:.1em;
               text-transform:uppercase;margin-bottom:24px;opacity:.8;"></div>
          <div id="crystalMeaning" style="font-size:.9rem;color:rgba(255,255,255,.6);
               line-height:1.8;margin-bottom:28px;"></div>

          <!-- Attributes -->
          <div id="crystalAttrs" style="display:flex;flex-direction:column;gap:10px;"></div>
      </div>
    </div>
  </div>
</section>

<!-- FOOTER -->
<footer>
  <div class="footer-brand">TH <em>true MILK</em> × True DNA</div>
  <div class="footer-copy">© 2026 TH True Milk. All rights reserved.</div>
</footer>

<script>
  /* ── CANVAS PARTICLES (background) ── */
  const canvas = document.getElementById('crystalCanvas');
  const ctx    = canvas.getContext('2d');
  function resize() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
  resize(); window.addEventListener('resize', resize);
  class Particle {
    constructor() { this.reset(); }
    reset() {
      this.x=Math.random()*canvas.width; this.y=Math.random()*canvas.height;
      this.size=Math.random()*1.8+.4; this.vx=(Math.random()-.5)*.3;
      this.vy=-Math.random()*.38-.08; this.alpha=Math.random()*.55+.1;
      this.life=0; this.maxLife=Math.random()*200+100;
      const r=Math.random();
      this.color=r>.65?`rgba(168,216,240,${this.alpha})`:r>.35?`rgba(0,114,206,${this.alpha})`:`rgba(201,168,76,${this.alpha})`;
      this.diamond=Math.random()>.82;
    }
    update(){ this.x+=this.vx; this.y+=this.vy; this.life++; if(this.life>this.maxLife||this.y<-10)this.reset(); }
    draw(){
      ctx.save(); ctx.globalAlpha=this.alpha*(1-this.life/this.maxLife); ctx.fillStyle=this.color;
      if(this.diamond){ const s=this.size*2.2; ctx.beginPath(); ctx.moveTo(this.x,this.y-s); ctx.lineTo(this.x+s*.55,this.y); ctx.lineTo(this.x,this.y+s); ctx.lineTo(this.x-s*.55,this.y); ctx.closePath(); ctx.fill(); }
      else { ctx.beginPath(); ctx.arc(this.x,this.y,this.size,0,Math.PI*2); ctx.fill(); }
      ctx.restore();
    }
  }
  const particles = Array.from({length:90},()=>new Particle());
  (function loop(){ ctx.clearRect(0,0,canvas.width,canvas.height); particles.forEach(p=>{p.update();p.draw();}); requestAnimationFrame(loop); })();

  /* ── SCROLL REVEAL ── */
  const obs = new IntersectionObserver((entries)=>{
    entries.forEach((e,i)=>{ if(e.isIntersecting) setTimeout(()=>e.target.classList.add('visible'),i*80); });
  },{threshold:.1});
  document.querySelectorAll('.reveal').forEach(r=>obs.observe(r));


  /* ══════════════════════════════════════════════════════
       CRYSTAL ENGINE v8 — Gemstone Artistic Renderer
       Kỹ thuật: multi-layer gradient · caustic light ·
       bezier curves · subsurface glow · specular bloom
  ══════════════════════════════════════════════════════ */

  function seededRNG(seed) {
    let s = seed >>> 0;
    return () => {
      s += 0x6D2B79F5;
      let t = Math.imul(s ^ s>>>15, 1 | s);
      t = t + Math.imul(t ^ t>>>7, 61 | t) ^ t;
      return ((t ^ t>>>14) >>> 0) / 4294967296;
    };
  }
  function hashCode(str) {
    let h = 2166136261;
    for (let i = 0; i < str.length; i++) { h ^= str.charCodeAt(i); h = Math.imul(h, 16777619); }
    return h >>> 0;
  }

  /* ── Shared rendering helpers ── */

  // Draw a filled polygon
  function fillPoly(c, pts, style) {
    c.beginPath(); c.moveTo(pts[0][0], pts[0][1]);
    pts.slice(1).forEach(p => c.lineTo(p[0], p[1]));
    c.closePath(); c.fillStyle = style; c.fill();
  }
  // Draw a stroked polygon
  function strokePoly(c, pts, style, lw=1) {
    c.beginPath(); c.moveTo(pts[0][0], pts[0][1]);
    pts.slice(1).forEach(p => c.lineTo(p[0], p[1]));
    c.closePath(); c.strokeStyle = style; c.lineWidth = lw; c.stroke();
  }

  // Radial glow blob
  function glow(c, x, y, r, color, a=0.18) {
    const g = c.createRadialGradient(x, y, 0, x, y, r);
    g.addColorStop(0, color.replace(')',`,${a})`).replace('hsl','hsla'));
    g.addColorStop(1, 'transparent');
    c.fillStyle = g; c.fillRect(0, 0, c.canvas.width, c.canvas.height);
  }

  // 8-pointed star sparkle
  function star(c, x, y, r, color, alpha=0.9) {
    c.save(); c.globalAlpha = alpha;
    c.fillStyle = color;
    c.beginPath();
    for (let i = 0; i < 8; i++) {
      const a = i * Math.PI / 4;
      const len = i % 2 === 0 ? r : r * 0.35;
      i === 0 ? c.moveTo(x + len*Math.cos(a), y + len*Math.sin(a))
               : c.lineTo(x + len*Math.cos(a), y + len*Math.sin(a));
    }
    c.closePath(); c.fill(); c.restore();
  }

  // Soft specular highlight ellipse
  function specular(c, x, y, rx, ry, angle, alpha) {
    c.save(); c.globalAlpha = alpha;
    const g = c.createRadialGradient(x, y, 0, x, y, Math.max(rx, ry));
    g.addColorStop(0, 'rgba(255,255,255,1)');
    g.addColorStop(0.4, 'rgba(255,255,255,0.4)');
    g.addColorStop(1, 'transparent');
    c.fillStyle = g;
    c.beginPath(); c.ellipse(x, y, rx, ry, angle, 0, Math.PI*2); c.fill();
    c.restore();
  }

  // Dark vignette around edges
  function vignette(c, W, H) {
    const g = c.createRadialGradient(W/2, H/2, W*0.3, W/2, H/2, W*0.75);
    g.addColorStop(0, 'transparent'); g.addColorStop(1, 'rgba(0,0,0,0.45)');
    c.fillStyle = g; c.fillRect(0, 0, W, H);
  }

  // Background gradient
  function drawBg(c, W, H, h1, h2, s=50, l1=8, l2=3) {
    const bg = c.createLinearGradient(0, 0, W*0.3, H);
    bg.addColorStop(0, `hsl(${h1},${s}%,${l1}%)`);
    bg.addColorStop(0.5, `hsl(${(h1+h2)/2},${s-5}%,${l1-1}%)`);
    bg.addColorStop(1, `hsl(${h2},${s-10}%,${l2}%)`);
    c.fillStyle = bg; c.fillRect(0, 0, W, H);
  }

  // Caustic light pattern (refracted light patches on "floor")
  function caustics(c, cx, baseY, W, hue, rng, n=5) {
    for (let i = 0; i < n; i++) {
      const x = cx + (rng()-0.5)*W*0.55, y = baseY + rng()*W*0.12;
      const rx = W*(0.04+rng()*0.08), ry = W*(0.01+rng()*0.025);
      c.save(); c.globalAlpha = rng()*0.12+0.04;
      c.beginPath(); c.ellipse(x, y, rx, ry, rng()*0.6-0.3, 0, Math.PI*2);
      c.fillStyle = `hsl(${hue+rng()*30-15},80%,85%)`; c.fill(); c.restore();
    }
  }

  // Internal fracture lines
  function fractures(c, cx, top, bot, W, hue, rng, n=5) {
    for (let i = 0; i < n; i++) {
      const x = cx+(rng()-0.5)*W*0.32, y = top+rng()*(bot-top);
      const ex = x+(rng()-0.5)*W*0.28, ey = y+(rng()-0.5)*(bot-top)*0.4;
      c.save(); c.globalAlpha = rng()*0.1+0.03;
      c.beginPath(); c.moveTo(x,y); c.lineTo(ex,ey);
      c.strokeStyle = `hsl(${hue+20},70%,92%)`; c.lineWidth = 0.6; c.stroke(); c.restore();
    }
  }

  /* ══════════════════════════════════════════════════════
     💠 CRYSTAL 1 — PHA LÊ THUẦN KHIẾT
     Visual: Classic brilliant diamond cut — 8 sharp facets,
     icy blue-white, intense internal fire, very refractive.
     Meaning: Tinh khiết như giọt sữa TH đầu tiên
  ══════════════════════════════════════════════════════ */
  function drawPhaLe(c, W, H, rng) {
    const cx = W/2 + (rng()-0.5)*16;
    const hue = 200 + rng()*20, sh = rng()*0.3+0.6;
    drawBg(c, W, H, hue-10, hue+20, 55, 11, 3);

    // Deep glow pools
    glow(c, cx, H*0.42, W*0.55, `hsl(${hue},75%,80%)`, 0.14);
    glow(c, cx-W*0.1, H*0.3, W*0.3, `hsl(${hue+20},85%,95%)`, 0.1);

    // Key points
    const tip  = [cx, H*0.07];
    const base = [cx, H*0.91];
    const ml   = [cx - W*0.29, H*0.44 + rng()*H*0.05];
    const mr   = [cx + W*0.30, H*0.42 + rng()*H*0.04];
    const bl   = [cx - W*0.13, H*0.88];
    const br   = [cx + W*0.13, H*0.88];
    const tl   = [cx - W*0.09, H*0.16];
    const tr   = [cx + W*0.10, H*0.15];

    // === SHADOW ===
    c.save(); c.globalAlpha = 0.2;
    fillPoly(c, [tip, mr, br, base, bl, ml].map(([x,y])=>[x+7,y+5]), '#000');
    c.restore();

    // === FACETS (back to front, darkest first) ===
    // Lower-left dark face
    const f1g = c.createLinearGradient(ml[0], ml[1], bl[0], bl[1]);
    f1g.addColorStop(0, `hsla(${hue},60%,35%,0.92)`);
    f1g.addColorStop(1, `hsla(${hue},50%,18%,0.95)`);
    fillPoly(c, [ml, bl, base], f1g);

    // Lower-right face
    const f2g = c.createLinearGradient(mr[0], mr[1], br[0], br[1]);
    f2g.addColorStop(0, `hsla(${hue+15},55%,52%,0.88)`);
    f2g.addColorStop(1, `hsla(${hue},45%,28%,0.92)`);
    fillPoly(c, [mr, br, base], f2g);

    // Mid-left face
    const f3g = c.createLinearGradient(ml[0], H*0.3, ml[0], ml[1]);
    f3g.addColorStop(0, `hsla(${hue},70%,72%,0.82)`);
    f3g.addColorStop(0.5, `hsla(${hue+10},65%,55%,0.78)`);
    f3g.addColorStop(1, `hsla(${hue},55%,32%,0.88)`);
    fillPoly(c, [tl, ml, bl], f3g);

    // Mid-right face (brightest)
    const f4g = c.createLinearGradient(tr[0], H*0.2, mr[0], mr[1]);
    f4g.addColorStop(0, `hsla(${hue+20},50%,92%,0.9)`);
    f4g.addColorStop(0.3, `hsla(${hue+10},65%,78%,0.85)`);
    f4g.addColorStop(0.7, `hsla(${hue},60%,55%,0.82)`);
    f4g.addColorStop(1, `hsla(${hue},50%,35%,0.9)`);
    fillPoly(c, [tr, mr, br, tl], f4g); // approximate center

    // Upper-left face
    const f5g = c.createLinearGradient(tip[0], tip[1], tl[0], tl[1]);
    f5g.addColorStop(0, `hsla(${hue},45%,88%,0.8)`);
    f5g.addColorStop(1, `hsla(${hue},60%,65%,0.75)`);
    fillPoly(c, [tip, tl, ml], f5g);

    // Upper-right face (very bright)
    const f6g = c.createLinearGradient(tip[0], tip[1], tr[0], H*0.25);
    f6g.addColorStop(0, `hsla(${hue+10},30%,98%,${sh*0.9})`);
    f6g.addColorStop(0.4, `hsla(${hue+15},50%,85%,0.85)`);
    f6g.addColorStop(1, `hsla(${hue},55%,62%,0.8)`);
    fillPoly(c, [tip, tr, mr], f6g);

    // Top table face
    const tg = c.createRadialGradient(cx, H*0.12, 2, cx, H*0.16, W*0.12);
    tg.addColorStop(0, `rgba(255,255,255,${sh*0.7+0.25})`);
    tg.addColorStop(0.6, `hsla(${hue+10},50%,88%,0.5)`);
    tg.addColorStop(1, `hsla(${hue},60%,65%,0.3)`);
    fillPoly(c, [tip, tl, tr], tg);

    // === INTERNAL FIRE (colored light inside) ===
    [[hue-30, 0.38, 0.52], [hue+40, 0.55, 0.62], [hue+15, 0.45, 0.73]].forEach(([h, rx, ry]) => {
      c.save(); c.globalAlpha = 0.06;
      const ig = c.createRadialGradient(cx+(rng()-0.5)*W*0.1, H*ry, 0, cx, H*ry, W*rx);
      ig.addColorStop(0, `hsl(${h},90%,75%)`); ig.addColorStop(1, 'transparent');
      c.fillStyle = ig; c.fillRect(0,0,W,H); c.restore();
    });

    fractures(c, cx, H*0.15, H*0.88, W, hue, rng, 6);
    caustics(c, cx, H*0.88, W, hue, rng, 6);

    // === EDGES ===
    [[tip,tl,ml,bl,base,br,mr,tr],[tip,tl],[tip,tr],[ml,bl],[mr,br]].forEach(pts => {
      c.beginPath(); c.moveTo(pts[0][0],pts[0][1]);
      pts.slice(1).forEach(p=>c.lineTo(p[0],p[1])); c.closePath();
      c.strokeStyle = `hsla(${hue+10},50%,90%,0.22)`; c.lineWidth = 0.8; c.stroke();
    });

    // === SPECULAR HIGHLIGHTS ===
    specular(c, tip[0], tip[1]+H*0.04, W*0.05, H*0.02, -0.2, sh*0.8+0.1);
    specular(c, cx-W*0.05, H*0.22, W*0.04, H*0.015, 0.3, sh*0.5+0.1);

    // === SPARKLES ===
    vignette(c, W, H);
    star(c, tip[0]+1, tip[1]+H*0.02, W*0.04, 'rgba(255,255,255,0.95)', 0.9);
    star(c, cx+W*0.14, H*0.35, W*0.018, 'rgba(220,240,255,0.8)', 0.7);
    for(let i=0;i<14;i++) {
      const sx=W*0.1+rng()*W*0.8, sy=H*0.05+rng()*H*0.9, ss=rng()*2+0.3;
      c.save(); c.globalAlpha=rng()*0.5+0.1;
      c.fillStyle=`hsla(${hue+rng()*30},70%,96%,1)`;
      c.beginPath(); c.arc(sx,sy,ss,0,Math.PI*2); c.fill(); c.restore();
    }
  }

  /* ══════════════════════════════════════════════════════
     🌟 CRYSTAL 2 — HƯỚNG DƯƠNG NĂNG LƯỢNG
     Visual: Citrine cluster — warm golden-amber prisms
     radiating from a glowing honey-colored base.
     Meaning: Năng lượng từ đồng cỏ Ba Vì dưới nắng vàng
  ══════════════════════════════════════════════════════ */
  function drawHuongDuong(c, W, H, rng) {
    const cx = W/2 + (rng()-0.5)*18;
    const hue = 40 + rng()*15, sh = rng()*0.3+0.55;
    drawBg(c, W, H, hue-10, hue+15, 60, 10, 3);

    glow(c, cx, H*0.52, W*0.6, `hsl(${hue},90%,65%)`, 0.2);
    glow(c, cx, H*0.45, W*0.3, `hsl(${hue+15},95%,80%)`, 0.12);

    // 5 prisms arranged in a burst — each slightly different
    const prisms = [
      { angle: -0.5,  cx: cx-W*0.12, top: H*0.08, h: H*0.62, w: W*0.13, bright: 0.08 },
      { angle:  0,    cx: cx,        top: H*0.04, h: H*0.70, w: W*0.16, bright: 0.12 },
      { angle:  0.45, cx: cx+W*0.13, top: H*0.1,  h: H*0.60, w: W*0.12, bright: 0.05 },
      { angle: -0.22, cx: cx-W*0.22, top: H*0.22, h: H*0.48, w: W*0.10, bright: -0.02 },
      { angle:  0.2,  cx: cx+W*0.24, top: H*0.25, h: H*0.44, w: W*0.09, bright: -0.04 },
    ];

    prisms.forEach((p, i) => {
      const hw = p.w/2;
      const tip = [p.cx + Math.sin(p.angle)*p.h*0.1, p.top];
      const bot = [p.cx, p.top + p.h + H*0.01];
      const lBot = [p.cx - hw*0.7, p.top + p.h];
      const rBot = [p.cx + hw*0.7, p.top + p.h];
      const lMid = [p.cx - hw, p.top + p.h*0.5];
      const rMid = [p.cx + hw, p.top + p.h*0.5];
      const lSho = [p.cx - hw*0.6 + Math.sin(p.angle)*10, p.top + p.h*0.12];
      const rSho = [p.cx + hw*0.6 + Math.sin(p.angle)*10, p.top + p.h*0.1];

      const lv = 65 + p.bright * 60;

      // Shadow under prism
      c.save(); c.globalAlpha = 0.15 - i*0.02;
      fillPoly(c, [tip, rSho, rMid, rBot, bot, lBot, lMid, lSho].map(([x,y])=>[x+5,y+4]), '#000');
      c.restore();

      // Right face
      const rg = c.createLinearGradient(rSho[0], tip[1], rBot[0], rBot[1]);
      rg.addColorStop(0, `hsla(${hue+18+i*2},80%,${lv+10}%,0.9)`);
      rg.addColorStop(0.35,`hsla(${hue+10},85%,${lv}%,0.88)`);
      rg.addColorStop(0.7, `hsla(${hue+5},75%,${lv-15}%,0.85)`);
      rg.addColorStop(1,   `hsla(${hue},65%,${lv-32}%,0.9)`);
      fillPoly(c, [tip, rSho, rMid, rBot, bot], rg);

      // Left face (slightly darker)
      const lg = c.createLinearGradient(lSho[0], tip[1], lBot[0], lBot[1]);
      lg.addColorStop(0, `hsla(${hue+8},70%,${lv+4}%,0.82)`);
      lg.addColorStop(0.4,`hsla(${hue},75%,${lv-8}%,0.8)`);
      lg.addColorStop(1,  `hsla(${hue-5},60%,${lv-28}%,0.88)`);
      fillPoly(c, [tip, lSho, lMid, lBot, bot], lg);

      // Top cap — bright
      const tg = c.createRadialGradient(p.cx, tip[1]+p.h*0.06, 1, p.cx, tip[1]+p.h*0.1, hw*1.5);
      tg.addColorStop(0, `rgba(255,255,255,${sh*0.6+0.25})`);
      tg.addColorStop(0.5,`hsla(${hue+20},70%,90%,0.42)`);
      tg.addColorStop(1, 'transparent');
      fillPoly(c, [tip, rSho, lSho], tg);

      // Center ridge highlight
      c.save(); c.globalAlpha = 0.18;
      c.beginPath(); c.moveTo(tip[0], tip[1]); c.lineTo(bot[0], bot[1]);
      c.strokeStyle = 'rgba(255,255,220,1)'; c.lineWidth = 0.9; c.stroke(); c.restore();

      // Edges
      strokePoly(c, [tip, rSho, rMid, rBot, bot, lBot, lMid, lSho], `hsla(${hue+20},70%,80%,0.2)`, 0.75);

      // Internal warm glow
      c.save(); c.globalAlpha = 0.08;
      const ig = c.createRadialGradient(p.cx, p.top+p.h*0.45, 2, p.cx, p.top+p.h*0.45, hw*2);
      ig.addColorStop(0, `hsl(${hue+30},95%,90%)`); ig.addColorStop(1, 'transparent');
      c.fillStyle = ig; c.fillRect(0,0,W,H); c.restore();
    });

    // Base glow / melting point
    const baseGlow = c.createRadialGradient(cx, H*0.75, 5, cx, H*0.78, W*0.3);
    baseGlow.addColorStop(0, `hsla(${hue+10},90%,75%,0.22)`);
    baseGlow.addColorStop(1, 'transparent');
    c.fillStyle = baseGlow; c.fillRect(0,0,W,H);

    caustics(c, cx, H*0.88, W, hue, rng, 7);
    vignette(c, W, H);

    // Sparkles on tips
    prisms.slice(0,3).forEach((p,i) => {
      star(c, p.cx+Math.sin(p.angle)*5, p.top+2, W*(0.035-i*0.006), 'rgba(255,248,200,0.95)', 0.85-i*0.1);
    });
    for(let i=0;i<10;i++) {
      c.save(); c.globalAlpha=rng()*0.45+0.1;
      c.fillStyle=`hsla(${hue+rng()*35-10},75%,95%,1)`;
      c.beginPath(); c.arc(W*0.1+rng()*W*0.8, H*0.05+rng()*H*0.9, rng()*2+0.3, 0, Math.PI*2); c.fill(); c.restore();
    }
  }

  /* ══════════════════════════════════════════════════════
     🌊 CRYSTAL 3 — ĐẠI DƯƠNG THUẦN KHIẾT
     Visual: Aquamarine tower — tall translucent column,
     green-blue gradient, like frozen seawater.
     Meaning: Nguồn nước suối Ba Vì trong lành
  ══════════════════════════════════════════════════════ */
  function drawDaiDuong(c, W, H, rng) {
    const cx = W/2 + (rng()-0.5)*14;
    const hue = 168 + rng()*24, sh = rng()*0.3+0.55;
    drawBg(c, W, H, hue-15, hue+20, 58, 9, 3);

    glow(c, cx, H*0.5, W*0.6, `hsl(${hue},80%,60%)`, 0.16);
    glow(c, cx-W*0.1, H*0.3, W*0.28, `hsl(${hue+20},90%,80%)`, 0.1);

    // 3 columns at different heights
    const cols = [
      { x: cx - W*0.19, top: H*0.12, h: H*0.72, w: W*0.155, lean: 4,  order: 2 },
      { x: cx + W*0.03, top: H*0.06, h: H*0.80, w: W*0.175, lean: -3, order: 3 },
      { x: cx + W*0.23, top: H*0.18, h: H*0.65, w: W*0.130, lean: 5,  order: 1 },
    ];

    cols.sort((a,b) => a.order - b.order).forEach((col) => {
      const hw = col.w/2, lx = col.lean;
      const tip   = [col.x + lx*0.3, col.top];
      const rSho  = [col.x + hw*0.7 + lx, col.top + col.h*0.09];
      const lSho  = [col.x - hw*0.7 + lx*0.5, col.top + col.h*0.09];
      const rWaist= [col.x + hw*0.95, col.top + col.h*0.5];
      const lWaist= [col.x - hw*0.95, col.top + col.h*0.5];
      const rBase = [col.x + hw*0.75, col.top + col.h];
      const lBase = [col.x - hw*0.75, col.top + col.h];
      const bot   = [col.x, col.top + col.h + H*0.01];

      // Shadow
      c.save(); c.globalAlpha = 0.15;
      fillPoly(c, [tip, rSho, rWaist, rBase, bot, lBase, lWaist, lSho].map(([x,y])=>[x+6,y+4]),'#000');
      c.restore();

      // Left face
      const lf = c.createLinearGradient(tip[0]-hw*0.5, col.top, lWaist[0], col.top+col.h);
      lf.addColorStop(0,   `hsla(${hue+20},70%,80%,0.75)`);
      lf.addColorStop(0.3, `hsla(${hue+12},72%,60%,0.72)`);
      lf.addColorStop(0.7, `hsla(${hue},   65%,40%,0.78)`);
      lf.addColorStop(1,   `hsla(${hue-5},55%,22%,0.85)`);
      fillPoly(c, [tip, lSho, lWaist, lBase, bot], lf);

      // Right face (lighter)
      const rf = c.createLinearGradient(tip[0]+hw*0.5, col.top, rWaist[0], col.top+col.h);
      rf.addColorStop(0,   `hsla(${hue+25},60%,88%,0.82)`);
      rf.addColorStop(0.25,`hsla(${hue+15},68%,72%,0.85)`);
      rf.addColorStop(0.6, `hsla(${hue+4},70%,46%,0.88)`);
      rf.addColorStop(1,   `hsla(${hue},52%,28%,0.92)`);
      fillPoly(c, [tip, rSho, rWaist, rBase, bot], rf);

      // Top cap
      const tc = c.createRadialGradient(col.x, col.top+col.h*0.05, 1, col.x, col.top+col.h*0.08, hw);
      tc.addColorStop(0, `rgba(255,255,255,${sh*0.6+0.25})`);
      tc.addColorStop(0.5,`hsla(${hue+25},65%,90%,0.42)`);
      tc.addColorStop(1, 'transparent');
      fillPoly(c, [[mx,mTop],mPts[1],mPts[9]], mTC);

      strokePoly(c, mPts, `hsla(${hue+15},65%,80%,0.22)`, 0.85);

      // Center spine
      c.save(); c.globalAlpha = 0.12;
      c.beginPath(); c.moveTo(mx, mTop); c.lineTo(mx+(rng()-0.5)*8, mBot);
      c.strokeStyle = 'rgba(255,255,255,0.9)'; c.lineWidth = 0.8; c.stroke(); c.restore();

      // Branch crystals
      const branches = [
        { side: -1, rootY: H*0.28, angle: -0.6, len: W*0.24, w: W*0.11, h: H*0.30 },
        { side:  1, rootY: H*0.20, angle:  0.52, len: W*0.27, w: W*0.12, h: H*0.26 },
        { side: -1, rootY: H*0.50, angle: -0.5,  len: W*0.19, w: W*0.09, h: H*0.23 },
        { side:  1, rootY: H*0.44, angle:  0.45, len: W*0.16, w: W*0.08, h: H*0.20 },
      ];

      branches.forEach((b, i) => {
        const rootX = mx + b.side * mw * 0.9;
        c.save(); c.translate(rootX, b.rootY); c.rotate(b.angle * b.side);
        const bw2 = b.w/2;
        const bpts = [
          [b.side*b.len,        0],
          [b.side*b.len*0.4,   -b.h*0.42],
          [b.side*b.len*0.18,  -b.h*0.5],
          [0,                  -bw2*0.45],
          [0,                   bw2*0.45],
          [b.side*b.len*0.18,   b.h*0.5],
          [b.side*b.len*0.4,    b.h*0.42],
        ];
        fillPoly(c, bpts, (() => {
          const bg = c.createLinearGradient(0, 0, b.side*b.len, 0);
          bg.addColorStop(0, `hsla(${hue+20},80%,72%,0.82)`);
          bg.addColorStop(0.45,`hsla(${hue+10},82%,55%,0.8)`);
          bg.addColorStop(1,   `hsla(${hue+2},70%,35%,0.85)`);
          return bg;
        })());
        // Tip highlight
        fillPoly(c, [[b.side*b.len,0],[b.side*b.len*0.4,-b.h*0.42],[b.side*b.len*0.18,-b.h*0.5],[0,-bw2*0.45],[0,0]],
          `hsla(${hue+28},62%,88%,0.3)`);
        strokePoly(c, bpts, `hsla(${hue+18},65%,78%,0.18)`, 0.65);
        c.restore();
      });

      fractures(c, mx, mTop, mBot, W, hue, rng, 5);
      caustics(c, cx, H*0.88, W, hue, rng, 6);
      vignette(c, W, H);

      // Tip specular + sparkles
      specular(c, mx, mTop+H*0.04, W*0.038, H*0.018, 0, sh*0.85+0.1);
      star(c, mx+1, mTop+3, W*0.038, 'rgba(255,220,180,0.95)', 0.88);
      for(let i=0;i<12;i++) {
        c.save(); c.globalAlpha=rng()*0.45+0.1;
        c.fillStyle=`hsla(${hue+rng()*35-10},75%,95%,1)`;
        c.beginPath(); c.arc(W*0.1+rng()*W*0.8, H*0.05+rng()*H*0.9, rng()*2+0.3, 0, Math.PI*2); c.fill(); c.restore();
      }
    });

    caustics(c, cx, H*0.88, W, hue, rng, 6);
    vignette(c, W, H);

    // Specular on each body
    bodies.forEach((b, i) => {
      specular(c, b.x+b.lean*0.3, b.topY+H*0.09, b.rw*0.24, b.h*0.02, b.lean*0.01, sh*0.6+0.12-i*0.07);
    });
    star(c, bodies[0].x+bodies[0].lean*0.3, bodies[0].topY+3, W*0.034, 'rgba(255,210,225,0.95)', 0.85);
    for(let i=0;i<13;i++) {
      c.save(); c.globalAlpha=rng()*0.45+0.1;
      c.fillStyle=`hsla(${hue+rng()*28-5},72%,96%,1)`;
      c.beginPath(); c.arc(W*0.1+rng()*W*0.8, H*0.05+rng()*H*0.9, rng()*2+0.3, 0, Math.PI*2); c.fill(); c.restore();
    }
  }

  /* ══════════════════════════════════════════════════════
     🔴 CRYSTAL 4 — SAN HÔ NHIỆT HUYẾT
     Visual: Red spessartine garnet — deep crimson with
     intense orange fire at edges, multi-shard burst.
     Meaning: Vươn tự do như nhánh san hô TH mở rộng
  ══════════════════════════════════════════════════════ */
  function drawSanHo(c, W, H, rng) {
    const cx = W/2 + (rng()-0.5)*16;
    const hue = 10 + rng()*15, sh = rng()*0.3+0.55;
    drawBg(c, W, H, hue-5, hue+20, 60, 9, 3);

    glow(c, cx, H*0.48, W*0.58, `hsl(${hue+5},88%,55%)`, 0.2);
    glow(c, cx, H*0.38, W*0.28, `hsl(${hue+20},95%,72%)`, 0.14);

    // Main central column
    const mw = W*0.165, mx = cx + (rng()-0.5)*12;
    const mTop = H*0.07, mBot = H*0.90;
    const mPts = [
      [mx, mTop],
      [mx+mw*0.6,  mTop+H*0.08],  [mx+mw, mTop+H*0.28],
      [mx+mw*0.95, mTop+H*0.60],  [mx+mw*0.65, mBot],
      [mx, mBot+H*0.01], [mx-mw*0.65, mBot],
      [mx-mw*0.95, mTop+H*0.60],  [mx-mw, mTop+H*0.28],
      [mx-mw*0.6,  mTop+H*0.08],
    ];

    // Shadow
    c.save(); c.globalAlpha = 0.18;
    fillPoly(c, mPts.map(([x,y])=>[x+7,y+5]), '#000');
    c.restore();

    // Left face
    const mLG = c.createLinearGradient(mx-mw, mTop, mx-mw*0.3, mBot);
    mLG.addColorStop(0,   `hsla(${hue+15},80%,75%,0.82)`);
    mLG.addColorStop(0.3, `hsla(${hue+8}, 72%,58%,0.8)`);
    mLG.addColorStop(0.7, `hsla(${hue},   65%,40%,0.85)`);
    mLG.addColorStop(1,   `hsla(${hue-5},55%,22%,0.9)`);
    fillPoly(c, [[mx,mTop],mPts[9],mPts[8],mPts[7],mPts[6],[mx,mBot+H*0.01]], mLG);

    // Right face
    const mRG = c.createLinearGradient(mx+mw*0.4, mTop, mx+mw, mBot);
    mRG.addColorStop(0,   `hsla(${hue+22},72%,86%,0.88)`);
    mRG.addColorStop(0.25,`hsla(${hue+12},78%,68%,0.85)`);
    mRG.addColorStop(0.6, `hsla(${hue+4},70%,46%,0.88)`);
    mRG.addColorStop(1,   `hsla(${hue},60%,25%,0.92)`);
    fillPoly(c, [[mx,mTop],mPts[1],mPts[2],mPts[3],mPts[4],[mx,mBot+H*0.01]], mRG);

    // Top cap
    const mTC = c.createRadialGradient(mx, mTop+H*0.04, 1, mx, mTop+H*0.08, mw);
    mTC.addColorStop(0, `rgba(255,255,255,${sh*0.65+0.22})`);
    mTC.addColorStop(0.5,`hsla(${hue+22},65%,92%,0.42)`);
    mTC.addColorStop(1, 'transparent');
    fillPoly(c, [[mx,mTop],mPts[1],mPts[9]], mTC);

    strokePoly(c, mPts, `hsla(${hue+15},65%,80%,0.22)`, 0.85);

    // Center spine
    c.save(); c.globalAlpha = 0.2;
    c.beginPath(); c.moveTo(mx, mTop); c.lineTo(mx+(rng()-0.5)*8, mBot);
    c.strokeStyle = 'rgba(255,200,180,1)'; c.lineWidth = 0.9; c.stroke(); c.restore();

    // Branch crystals
    const branches = [
      { side: -1, rootY: H*0.28, angle: -0.6, len: W*0.24, w: W*0.11, h: H*0.30 },
      { side:  1, rootY: H*0.20, angle:  0.52, len: W*0.27, w: W*0.12, h: H*0.26 },
      { side: -1, rootY: H*0.50, angle: -0.5,  len: W*0.19, w: W*0.09, h: H*0.23 },
      { side:  1, rootY: H*0.44, angle:  0.45, len: W*0.16, w: W*0.08, h: H*0.20 },
    ];

    branches.forEach((b, i) => {
      const rootX = mx + b.side * mw * 0.9;
      c.save(); c.translate(rootX, b.rootY); c.rotate(b.angle * b.side);
      const bw2 = b.w/2;
      const bpts = [
        [b.side*b.len,        0],
        [b.side*b.len*0.4,   -b.h*0.42],
        [b.side*b.len*0.18,  -b.h*0.5],
        [0,                  -bw2*0.45],
        [0,                   bw2*0.45],
        [b.side*b.len*0.18,   b.h*0.5],
        [b.side*b.len*0.4,    b.h*0.42],
      ];
      fillPoly(c, bpts, (() => {
        const bg = c.createLinearGradient(0, 0, b.side*b.len, 0);
        bg.addColorStop(0, `hsla(${hue+20},80%,72%,0.82)`);
        bg.addColorStop(0.45,`hsla(${hue+10},82%,55%,0.8)`);
        bg.addColorStop(1,   `hsla(${hue+2},70%,35%,0.85)`);
        return bg;
      })());
      // Tip highlight
      fillPoly(c, [[b.side*b.len,0],[b.side*b.len*0.4,-b.h*0.42],[b.side*b.len*0.18,-b.h*0.5],[0,-bw2*0.45],[0,0]],
        `hsla(${hue+28},62%,88%,0.3)`);
      strokePoly(c, bpts, `hsla(${hue+18},65%,78%,0.18)`, 0.65);
      c.restore();
    });

    fractures(c, mx, mTop, mBot, W, hue, rng, 5);
    caustics(c, cx, H*0.88, W, hue, rng, 6);
    vignette(c, W, H);

    // Tip specular + sparkles
    specular(c, mx, mTop+H*0.04, W*0.038, H*0.018, 0, sh*0.85+0.1);
    star(c, mx+1, mTop+3, W*0.038, 'rgba(255,220,180,0.95)', 0.88);
    for(let i=0;i<12;i++) {
      c.save(); c.globalAlpha=rng()*0.45+0.1;
      c.fillStyle=`hsla(${hue+rng()*35-10},75%,95%,1)`;
      c.beginPath(); c.arc(W*0.1+rng()*W*0.8, H*0.05+rng()*H*0.9, rng()*2+0.3, 0, Math.PI*2); c.fill(); c.restore();
    }
  }

  /* ══════════════════════════════════════════════════════
     💠 CRYSTAL 5 — THẠCH ANH TÍM HUYỀN BÍ
     Visual: Amethyst geode — deep violet hexagonal
     prisms with phantom inclusions and phantom zones.
     Meaning: Chiều sâu trí tuệ tích lũy theo thời gian
  ══════════════════════════════════════════════════════ */
  function drawThachAnh(c, W, H, rng) {
    const cx = W/2 + (rng()-0.5)*14;
    const hue = 272 + rng()*26, sh = rng()*0.3+0.5;
    drawBg(c, W, H, hue-20, hue+15, 45, 8, 2);

    glow(c, cx, H*0.48, W*0.6, `hsl(${hue},75%,65%)`, 0.15);
    glow(c, cx-W*0.08, H*0.32, W*0.28, `hsl(${hue+25},85%,80%)`, 0.1);

    // Hexagonal prism — 3 visible faces
    const hR = W*0.27, pH = H*0.63, startY = H*0.09, endY = startY + pH;
    const tipY = startY - H*0.055;

    // Compute hex vertices at top and bottom
    const hexTop = Array.from({length:6}, (_,i) => {
      const a = i*Math.PI/3 - Math.PI/6;
      return [cx + hR*Math.cos(a), startY + hR*0.22*Math.sin(a)];
    });
    const hexBot = Array.from({length:6}, (_,i) => {
      const a = i*Math.PI/3 - Math.PI/6;
      return [cx + hR*Math.cos(a)*0.92, endY + hR*0.15*Math.sin(a)];
    });

    // Shadow
    c.save(); c.globalAlpha = 0.18;
    const shadowPts = [...hexTop, ...hexBot].map(([x,y])=>[x+8,y+5]);
    c.beginPath(); shadowPts.forEach(([x,y],i) => i===0?c.moveTo(x,y):c.lineTo(x,y)); c.closePath();
    c.fillStyle = '#000'; c.fill(); c.restore();

    // Draw 3 visible rectangular faces
    const faceData = [
      { i: 0, lightFactor: 1.0,  satBoost: 0 },
      { i: 1, lightFactor: 0.72, satBoost: 5 },
      { i: 2, lightFactor: 0.50, satBoost: 8 },
    ];
    faceData.forEach(({ i, lightFactor: lf }) => {
      const t1 = hexTop[i], t2 = hexTop[(i+1)%6];
      const b1 = hexBot[i], b2 = hexBot[(i+1)%6];
      const fg = c.createLinearGradient(t1[0], startY, t1[0], endY);
      const hl = 68 * lf, ll = 28 * lf;
      fg.addColorStop(0,   `hsla(${hue+18},68%,${hl+6}%,${0.82+lf*0.05})`);
      fg.addColorStop(0.35,`hsla(${hue+8}, 72%,${hl   }%,${0.8+lf*0.04})`);
      fg.addColorStop(0.7, `hsla(${hue},   65%,${hl*.65}%,${0.82+lf*0.04})`);
      fg.addColorStop(1,   `hsla(${hue-10},55%,${ll    }%,${0.85})`);
      fillPoly(c, [t1, t2, b2, b1], fg);
      // Edge line
      c.beginPath(); c.moveTo(t1[0],t1[1]); c.lineTo(b1[0],b1[1]);
      c.strokeStyle = `hsla(${hue+20},60%,85%,0.22)`; c.lineWidth = 0.8; c.stroke();
    });

    // Top hexagon face
    c.beginPath();
    hexTop.forEach(([x,y],i) => i===0 ? c.moveTo(x,y) : c.lineTo(x,y));
    c.closePath();
    const thg = c.createRadialGradient(cx, startY, 2, cx, startY, hR*0.9);
    thg.addColorStop(0, `rgba(255,255,255,${sh*0.55+0.25})`);
    thg.addColorStop(0.45, `hsla(${hue+20},55%,85%,0.5)`);
    thg.addColorStop(1, `hsla(${hue},60%,55%,0.3)`);
    c.fillStyle = thg; c.fill();
    strokePoly(c, hexTop, `hsla(${hue+15},55%,82%,0.2)`, 0.7);

    // Crystal tip (termination)
    const tipPts = [
      hexTop[0], hexTop[1], [cx, tipY]
    ];
    const tTG = c.createLinearGradient(hexTop[0][0], startY, cx, tipY);
    tTG.addColorStop(0, `hsla(${hue},55%,65%,0.8)`);
    tTG.addColorStop(1, `hsla(${hue+20},50%,92%,0.85)`);
    fillPoly(c, tipPts, tTG);
    // Other tip faces
    [[1,2],[2,3]].forEach(([a,b]) => {
      const brightness = 0.8 - b*0.12;
      fillPoly(c, [hexTop[a], hexTop[b], [cx, tipY]],
        `hsla(${hue+10},55%,${58*brightness}%,${brightness*0.82})`);
    });

    // Bottom termination
    fillPoly(c, [hexBot[2], hexBot[3], [cx, endY+H*0.08]],
      `hsla(${hue-10},48%,20%,0.85)`);

    // Phantom zones (growth layers visible inside)
    for(let j=0;j<4;j++) {
      const py = startY + pH*(0.15+j*0.18);
      c.save(); c.globalAlpha = 0.07+rng()*0.04;
      c.beginPath(); c.ellipse(cx, py, hR*0.55, pH*0.013, rng()*0.4-0.2, 0, Math.PI*2);
      c.fillStyle = `hsl(${hue+j*15},70%,82%)`; c.fill(); c.restore();
    }

    // Satellite crystal (smaller, left)
    const sx=cx-W*0.3, sTop=H*0.32, sH=H*0.3, sR=W*0.095;
    const sHexT = Array.from({length:6}, (_,i) => {
      const a = i*Math.PI/3 - Math.PI/6;
      return [sx + sR*Math.cos(a), sTop + sR*0.25*Math.sin(a)];
    });
    c.beginPath(); sHexT.forEach(([x,y],i) => i===0?c.moveTo(x,y):c.lineTo(x,y)); c.closePath();
    const sTG = c.createRadialGradient(sx, sTop, 1, sx, sTop, sR);
    sTG.addColorStop(0, `hsla(${hue+20},55%,80%,0.6)`); sTG.addColorStop(1, `hsla(${hue},50%,45%,0.5)`);
    c.fillStyle=sTG; c.fill();
    [[0,1],[1,2]].forEach(([a,b]) => {
      const sb1=sHexT[a], sb2=sHexT[(a+1)%6];
      fillPoly(c, [sb1, sb2, [sx, sTop+sH], [sx+sR*(b?0.4:-0.4), sTop+sH]], `hsla(${hue+(b?10:-5)},60%,${62-b*15}%,0.7)`);
    });
    // Satellite tip
    fillPoly(c, [sHexT[0], sHexT[1], [sx+sR*0.3, sTop-sH*0.5]], `hsla(${hue+22},50%,88%,0.6)`);

    fractures(c, cx, startY, endY, W, hue, rng, 6);
    caustics(c, cx, endY+H*0.06, W, hue, rng, 5);
    vignette(c, W, H);

    specular(c, cx, tipY+H*0.02, W*0.04, H*0.018, 0, sh*0.8+0.12);
    star(c, cx, tipY+3, W*0.036, 'rgba(230,200,255,0.95)', 0.85);
    for(let i=0;i<12;i++) {
      c.save(); c.globalAlpha=rng()*0.45+0.1;
      c.fillStyle=`hsla(${hue+rng()*35-10},75%,95%,1)`;
      c.beginPath(); c.arc(W*0.1+rng()*W*0.8, H*0.05+rng()*H*0.9, rng()*2+0.3, 0, Math.PI*2); c.fill(); c.restore();
    }
  }

  /* ══════════════════════════════════════════════════════
     🌸 CRYSTAL 6 — HỒNG NGỌC ÊM ÁI
     Visual: Rose quartz slab — two interlocking columns,
     soft pink with silky internal cloudiness.
     Meaning: Tình yêu bền bỉ như sữa TH mỗi buổi sáng
  ══════════════════════════════════════════════════════ */
  function drawHongNgoc(c, W, H, rng) {
    const cx = W/2 + (rng()-0.5)*12;
    const hue = 338 + rng()*20, sh = rng()*0.3+0.52;
    drawBg(c, W, H, hue-15, hue+15, 48, 9, 3);

    glow(c, cx-W*0.04, H*0.42, W*0.58, `hsl(${hue},80%,70%)`, 0.16);
    glow(c, cx-W*0.1, H*0.3, W*0.3, `hsl(${hue+15},88%,85%)`, 0.1);

    // Two interlocked prisms
    const bodies = [
      { x: cx-W*0.07, topY: H*0.07, h: H*0.76, rw: W*0.21, lean: W*0.018, al: 0.88 },
      { x: cx+W*0.11, topY: H*0.15, h: H*0.68, rw: W*0.185,lean:-W*0.012, al: 0.82 },
    ];

    bodies.forEach((b, bi) => {
      const hw = b.rw/2, lx = b.lean;
      const tipX = b.x + lx*0.35, tipY = b.topY;
      const rS = [b.x + hw*0.62 + lx, b.topY + b.h*0.08];
      const lS = [b.x - hw*0.62 + lx*0.4, b.topY + b.h*0.08];
      const rW = [b.x + b.rw*0.52, b.topY + b.h*0.42];
      const lW = [b.x - b.rw*0.52, b.topY + b.h*0.42];
      const rB = [b.x + b.rw*0.44, b.topY + b.h*0.84];
      const lB = [b.x - b.rw*0.44, b.topY + b.h*0.84];
      const rF = [b.x + b.rw*0.28, b.topY + b.h];
      const lF = [b.x - b.rw*0.28, b.topY + b.h];
      const bot = [b.x, b.topY + b.h + H*0.01];

      // Shadow
      c.save(); c.globalAlpha = 0.15 - bi*0.04;
      const shadPts = [[tipX,tipY],rS,rW,rB,rF,bot,lF,lB,lW,lS].map(([x,y])=>[x+6,y+5]);
      fillPoly(c, shadPts, '#000'); c.restore();

      // Right face
      const rfg = c.createLinearGradient(tipX, tipY, rW[0], b.topY+b.h);
      rfg.addColorStop(0,   `hsla(${hue+14},68%,90%,${b.al})`);
      rfg.addColorStop(0.28,`hsla(${hue+7}, 72%,72%,${b.al*0.96})`);
      rfg.addColorStop(0.62,`hsla(${hue+2}, 65%,50%,${b.al*0.92})`);
      rfg.addColorStop(1,   `hsla(${hue-7}, 55%,28%,${b.al})`);
      fillPoly(c, [[tipX,tipY], rS, rW, rB, rF, bot], rfg);

      // Left face
      const lfg = c.createLinearGradient(tipX, tipY, lW[0], b.topY+b.h);
      lfg.addColorStop(0,   `hsla(${hue+18},58%,84%,${b.al*0.88})`);
      lfg.addColorStop(0.35,`hsla(${hue+10},62%,65%,${b.al*0.85})`);
      lfg.addColorStop(0.7, `hsla(${hue+3}, 56%,44%,${b.al*0.88})`);
      lfg.addColorStop(1,   `hsla(${hue-5}, 48%,25%,${b.al*0.9})`);
      fillPoly(c, [[tipX,tipY], lS, lW, lB, lF, bot], lfg);

      // Top cap (warm bright)
      const tcg = c.createRadialGradient(b.x, tipY+b.h*0.05, 1, b.x, tipY+b.h*0.09, hw*1.2);
      tcg.addColorStop(0, `rgba(255,255,255,${sh*0.55+0.22})`);
      tcg.addColorStop(0.5,`hsla(${hue+22},65%,92%,0.42)`);
      tcg.addColorStop(1,  'transparent');
      fillPoly(c, [[tipX,tipY], rS, lS], tcg);

      // Bottom tip
      fillPoly(c, [rF, bot, lF], `hsla(${hue-8},45%,20%,0.82)`);

      // Silky internal cloudiness (rose quartz signature)
      for (let j = 0; j < 5; j++) {
        const fy = b.topY + b.h*(0.18+j*0.14) + rng()*b.h*0.06;
        const fx = b.x + (rng()-0.5)*hw*0.5;
        c.save(); c.globalAlpha = 0.07+rng()*0.06;
        c.beginPath(); c.ellipse(fx, fy, hw*(0.35+rng()*0.2), b.h*0.016, rng()*0.4-0.2, 0, Math.PI*2);
        c.fillStyle = `hsl(${hue+25},70%,95%)`; c.fill(); c.restore();
      }

      // Center spine
      c.save(); c.globalAlpha = 0.14+bi*0.03;
      c.beginPath(); c.moveTo(tipX, tipY); c.lineTo(bot[0], bot[1]);
      c.strokeStyle = 'rgba(255,220,230,0.9)'; c.lineWidth = 0.85; c.stroke(); c.restore();

      fractures(c, b.x, b.topY, b.topY+b.h, b.rw*2, hue, rng, 3);

      // Edge
      strokePoly(c, [[tipX,tipY],rS,rW,rB,rF,bot,lF,lB,lW,lS],
        `hsla(${hue+18},55%,84%,0.2)`, 0.75);
    });

    // Warm blush glow between the two bodies
    const blush = c.createRadialGradient(cx, H*0.45, 5, cx, H*0.45, W*0.2);
    blush.addColorStop(0, `hsla(${hue+10},80%,82%,0.12)`);
    blush.addColorStop(1, 'transparent');
    c.fillStyle = blush; c.fillRect(0,0,W,H);

    caustics(c, cx, H*0.88, W, hue, rng, 6);
    vignette(c, W, H);

    // Specular on each body
    bodies.forEach((b, i) => {
      specular(c, b.x+b.lean*0.3, b.topY+H*0.09, b.rw*0.24, b.h*0.02, b.lean*0.01, sh*0.6+0.12-i*0.07);
    });
    star(c, bodies[0].x+bodies[0].lean*0.3, bodies[0].topY+3, W*0.034, 'rgba(255,210,225,0.95)', 0.85);
    for(let i=0;i<13;i++) {
      c.save(); c.globalAlpha=rng()*0.45+0.1;
      c.fillStyle=`hsla(${hue+rng()*28-5},72%,96%,1)`;
      c.beginPath(); c.arc(W*0.1+rng()*W*0.8, H*0.05+rng()*H*0.9, rng()*2+0.3, 0, Math.PI*2); c.fill(); c.restore();
    }
  }

  /* ── Crystal registry ── */
  const CRYSTAL_TYPES = [
    {
      name: 'Tinh Thể Pha Lê',
      type: 'PHA LÊ',
      tag:  'hsl(200,70%,72%)',
      meaning: 'Trong vắt như giọt sữa TH đầu tiên chắt lọc từ đồng cỏ sạch — không pha tạp, không thêm thắt. Bạn là người trân trọng sự thật thuần khiết và nhìn thấu bản chất của mọi thứ.',
      draw: drawPhaLe
    },
    {
      name: 'Tinh Thể Hướng Dương',
      type: 'HƯỚNG DƯƠNG',
      tag:  'hsl(44,90%,65%)',
      meaning: 'Rực rỡ như đồng cỏ Ba Vì dưới nắng vàng — nơi đàn bò TH hấp thu năng lượng đất trời mỗi ngày. Bạn mang trong mình nguồn sinh lực ấm áp, lan tỏa và không bao giờ cạn kiệt.',
      draw: drawHuongDuong
    },
    {
      name: 'Tinh Thể Đại Dương',
      type: 'ĐẠI DƯƠNG',
      tag:  'hsl(175,70%,58%)',
      meaning: 'Trong lành như nguồn nước suối Ba Vì chảy mãi không ngừng — nơi TH bắt đầu câu chuyện sữa sạch cho người Việt. Bạn là người mang lại sự bình yên và tươi mát cho mọi người.',
      draw: drawDaiDuong
    },
    {
      name: 'Tinh Thể San Hô',
      type: 'SAN HÔ',
      tag:  'hsl(18,88%,65%)',
      meaning: 'Vươn nhánh tự do như hành trình TH không ngừng mở rộng từ một cốc sữa đến trăm sản phẩm dinh dưỡng. Bạn dám khác biệt, dám phá vỡ ranh giới và tạo nên những điều chưa từng có.',
      draw: drawSanHo
    },
    {
      name: 'Tinh Thể Thạch Anh',
      type: 'THẠCH ANH TÍM',
      tag:  'hsl(282,68%,72%)',
      meaning: 'Huyền bí như bí quyết từng giọt sữa TH — tích lũy từng tầng giá trị qua năm tháng. Bạn là người mang chiều sâu tri thức và trí tuệ nội tâm mà không phải ai cũng dễ dàng khám phá.',
      draw: drawThachAnh
    },
    {
      name: 'Tinh Thể Hồng Ngọc',
      type: 'HỒNG NGỌC',
      tag:  'hsl(345,72%,72%)',
      meaning: 'Ấm áp như bàn tay người mẹ pha ly sữa TH mỗi sáng cho con — sự yêu thương bền bỉ, lặng lẽ nhưng thấm vào từng khoảnh khắc. Bạn là trái tim ấm áp, là chỗ dựa vững chắc của mọi người.',
      draw: drawHongNgoc
    },
  ];

  const ATTR_NAMES = ['Độ tinh khiết','Năng lượng','Cộng hưởng','Độ hiếm','Ánh sáng nội tâm'];

  function drawCrystal(seedNum, ctype, rng) {
    const cv = document.getElementById('crystalCanvas2');
    const c  = cv.getContext('2d');
    c.clearRect(0, 0, cv.width, cv.height);
    ctype.draw(c, cv.width, cv.height, rng);
    // Subtle watermark
    c.save(); c.globalAlpha = 0.045;
    c.font = `300 ${cv.height*0.15}px 'Cormorant Garamond',serif`;
    c.fillStyle = 'white'; c.textAlign = 'center'; c.textBaseline = 'middle';
    c.fillText('TH', cv.width/2, cv.height*0.52); c.restore();
  }

  function generateCrystal() {
    const raw = document.getElementById('codeInput').value.trim();
    if (!raw) {
      const inp = document.getElementById('codeInput');
      inp.style.borderColor = 'rgba(255,80,80,.7)';
      inp.placeholder = 'Vui lòng nhập mã thẻ cào!';
      setTimeout(() => { inp.style.borderColor='rgba(0,114,206,.35)'; inp.placeholder='Nhập mã thẻ cào (VD: TH-2026-XXXXXXXX)'; }, 2200);
      return;
    }
    const btn = document.getElementById('codeSubmit');
    btn.textContent = '✦ Đang đúc...'; btn.style.opacity = '.65';

    setTimeout(() => {
      const tc = new Date().getMinutes() + new Date().getSeconds();
      const seedNum = hashCode(raw.toUpperCase() + '|' + tc);
      const rng     = seededRNG(seedNum);
      const typeIdx = hashCode(raw.toUpperCase()) % CRYSTAL_TYPES.length;
      const ctype   = CRYSTAL_TYPES[typeIdx];
      const codeRng = seededRNG(hashCode(raw.toUpperCase()));
      const attrs   = ATTR_NAMES.map(n => ({ name: n, val: Math.floor(codeRng()*35)+65 }));

      drawCrystal(seedNum, ctype, rng);

      document.getElementById('crystalName').textContent    = ctype.name;
      document.getElementById('crystalType').textContent    = '✦ ' + ctype.type + ' ✦';
      document.getElementById('crystalType').style.color    = ctype.tag;
      document.getElementById('crystalMeaning').textContent = ctype.meaning;

      document.getElementById('crystalAttrs').innerHTML = attrs.map(a => `
        <div style="display:flex;align-items:center;gap:12px;">
          <span style="font-size:.74rem;color:rgba(255,255,255,.42);min-width:120px;">${a.name}</span>
          <div style="flex:1;height:3px;background:rgba(255,255,255,.07);border-radius:2px;overflow:hidden;">
            <div style="height:100%;width:${a.val}%;background:linear-gradient(90deg,${ctype.tag},rgba(255,255,255,.7));border-radius:2px;"></div>
          </div>
          <span style="font-size:.74rem;color:rgba(255,255,255,.65);min-width:28px;text-align:right;">${a.val}</span>
        </div>`).join('');
      const out = document.getElementById('crystalOutput');
      out.style.display = 'block';
      out.scrollIntoView({ behavior: 'smooth', block: 'center' });

      btn.textContent = '✦ Đúc lại';
      btn.style.opacity = '1';
      btn.style.background = 'linear-gradient(135deg,#002B5C,var(--blue-bright))';
    }, 900);
  }

  function downloadCrystal() {
    const cv   = document.getElementById('crystalCanvas2');
    const name = document.getElementById('crystalName').textContent || 'tinh-the';
    const link = document.createElement('a');
    link.download = name.replace(/\s+/g,'-').toLowerCase() + '.png';
    link.href = cv.toDataURL('image/png'); link.click();
  }

  document.getElementById('codeInput').addEventListener('keydown', e => {
    if (e.key === 'Enter') generateCrystal();
  });
</script>
</body>
</html>
